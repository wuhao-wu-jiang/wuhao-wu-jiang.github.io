<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="WOW">
<meta property="og:url" content="http://example.com/page/9/index.html">
<meta property="og:site_name" content="WOW">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="WOW">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/9/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>WOW</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">WOW</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">你生之前悠悠千載已逝<br>未來還會有千年沉寂的期待</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/07/Morris-Counter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/07/Morris-Counter/" class="post-title-link" itemprop="url">Morris Counter</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-07 15:29:06" itemprop="dateCreated datePublished" datetime="2021-02-07T15:29:06+11:00">2021-02-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-25 19:30:11" itemprop="dateModified" datetime="2021-02-25T19:30:11+11:00">2021-02-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="problem">Problem</h3>
<p>Given a stream <span class="math inline">\(S\)</span> of <span class="math inline">\(n\)</span> elements, a server that observes the elements in <span class="math inline">\(S\)</span> one by one is required to estimate the cardinality <span class="math inline">\(n\)</span> with less than <span class="math inline">\(\log n\)</span> bits, with relative error <span class="math inline">\(\epsilon \in (0, 1)\)</span> and failure probability <span class="math inline">\(\delta\)</span>.</p>
<p>Let <span class="math inline">\(w \in (1, 2)\)</span> be some parameter to be determined.</p>
<blockquote>
<p><strong>Algorithm</strong>. Morris Counter<br />
1. <span class="math inline">\(k \leftarrow 0; \quad X_0 \leftarrow 0\)</span>; (introduced only for analysis)</p>
<ol start="2" type="1">
<li><p>For <span class="math inline">\(t \leftarrow 1\)</span> to <span class="math inline">\(n\)</span>:</p></li>
<li><p><span class="math inline">\(\qquad\)</span> <span class="math inline">\(X_t \leftarrow X_{t - 1}\)</span>; (introduced only for analysis)</p></li>
<li><p><span class="math inline">\(\qquad\)</span> With probability <span class="math inline">\(p_t \doteq 1 / w^k\)</span> do:</p></li>
<li><p><span class="math inline">\(\qquad\)</span> <span class="math inline">\(\qquad\)</span> <span class="math inline">\(X_t \leftarrow X_t + w^k\)</span>;</p></li>
<li><p><span class="math inline">\(\qquad\)</span> <span class="math inline">\(\qquad\)</span> <span class="math inline">\(k \leftarrow k + 1\)</span>;</p></li>
<li><p>Output <span class="math inline">\(\frac{w^k - 1}{w - 1}\)</span>.</p></li>
</ol>
</blockquote>
<p>It can be verified that, when the algorithm stops, <span class="math inline">\(X_n = \frac{w^k - 1}{w - 1}\)</span>.</p>
<blockquote>
<p><strong>Theorem.</strong> <span class="math inline">\(\forall 0 \le t \le n\)</span>, <span class="math inline">\(\mathbb{E} [ X_t ] = t\)</span>.</p>
</blockquote>
<p><em>Proof:</em> Clearly, <span class="math inline">\(\mathbb{E} [ X_0 ] = 0\)</span>. For <span class="math inline">\(t \ge 1\)</span>, <span class="math display">\[
    \mathbb{E} [ X_t \mid X_{t - 1} ] = p_t \cdot \left( X_{t - 1} + \frac{1}{p_t} \right) + ( 1 - p_t ) \cdot X_{t - 1} = X_{t - 1} + 1. 
\]</span></p>
<p>Hence, by induction on <span class="math inline">\(t\)</span>, we have <span class="math display">\[
    \mathbb{E} [ X_t ] = \mathbb{E} [ \mathbb{E} [ X_t \mid X_{t - 1} ] ] = \mathbb{E} [ X_{t - 1} ] + 1 = t. 
\]</span></p>
<p><span class="math inline">\(\square\)</span></p>
<blockquote>
<p><strong>Theorem.</strong> <span class="math inline">\(\forall t \in [n]\)</span>, <span class="math inline">\(\mathbb{Var } [ X_t ] = (w - 1) \cdot \frac{ t^2 }{ 2 }\)</span>.</p>
</blockquote>
<p><em>Proof:</em> For <span class="math inline">\(t \ge 1\)</span>, it holds that <span class="math inline">\(X_{t - 1} = \frac{ 1 / p_t - 1}{w - 1}\)</span>. Therefore,</p>
<p><span class="math display">\[
1 / p_t = (w - 1) \cdot X_{t - 1} + 1
\]</span> and <span class="math display">\[
\begin{aligned}
     \mathbb{E} [ X_t^2 | X_{t - 1} ] 
            &amp;= p_t \cdot  \left( X_{t - 1} + 1 / p_t \right)^2 + ( 1 - p_t ) \cdot (X_{t - 1})^2 \\
            &amp;= 1 / p_t + 2 \cdot X_{t - 1} + (X_{t - 1})^2 \\
            &amp;= (w + 1) \cdot X_{t - 1}  + 1 + (X_{t - 1})^2 
\end{aligned}
\]</span></p>
<p>Therefore, since <span class="math inline">\(X_0 = 0\)</span>, <span class="math display">\[
\begin{aligned}
     \mathbb{E} [ X_t^2 ] 
                &amp;= \mathbb{E} [ \mathbb{E} [ X_t^2 | X_{t - 1}  ] ] \\
                &amp;= (w + 1) \cdot \mathbb{E}  [ X_{t - 1} ] + 1 +  \mathbb{E}  [ X_{t - 1} ^2] \\
                &amp;=  \mathbb{E}  [ X_{t - 1}^2 ] + (w + 1) \cdot (t - 1) + 1 \\
                &amp;... \\
                &amp;=  \mathbb{E}  [ X_0^2 ] + (w + 1) \cdot \sum_{i = 0}^{t - 1} i + t  \\
                &amp;= (w + 1) \cdot \frac{ t (t - 1) }{ 2 } + t \\
                &amp;\le (w - 1) \cdot \frac{ t^2 }{ 2 } + t^2, 
\end{aligned}
\]</span></p>
<p>and <span class="math display">\[
    \mathbb{Var } [ X_t ] = \mathbb{E} [ X_t^2 ]  - (\mathbb{E} [ X_t ])^2 \le (w - 1) \cdot \frac{ t^2 }{ 2 } . 
\]</span></p>
<blockquote>
<p><strong>Corollary.</strong> By Chebyshev's inequality, <span class="math display">\[
\Pr[ | X_t - t | \ge \epsilon \cdot t ] \le (w - 1) \cdot \frac{ t^2 }{ 2 \epsilon^2 \cdot t^2} = \frac{w - 1}{ 2 \epsilon^2 }.
\]</span></p>
</blockquote>
<blockquote>
<p><strong>Corollary.</strong> If we set <span class="math inline">\(w = 1 + 2 \epsilon^2 \delta\)</span>, then the failure probability is at most <span class="math inline">\(\delta\)</span>.</p>
</blockquote>
<h2 id="reference.">Reference.</h2>
<p>[1] G. Cormode and K. Yi, Small Summaries for Big Data, 1st ed. Cambridge University Press, 2020.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/02/Fast-Fourier-Transform/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/02/Fast-Fourier-Transform/" class="post-title-link" itemprop="url">Fast Fourier Transform</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-02 10:31:22" itemprop="dateCreated datePublished" datetime="2021-02-02T10:31:22+11:00">2021-02-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-04 22:50:26" itemprop="dateModified" datetime="2021-02-04T22:50:26+11:00">2021-02-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <!-- ![](https://github.com/wuhao-wu-jiang/BlogImgs/blob/master/FastFourierTransformation/0.npng?raw=true) -->
<p>In the discrete Fourier transform, we want to project a vector <span class="math inline">\(v \in \mathbb{C}^n\)</span> to the orthonormal bases <span class="math display">\[
\begin{aligned}
    &amp;e_0 = \frac{1}{\sqrt n} ( e^{ 0 \cdot \frac{2 \cdot 0 \cdot \pi i}{ n} }, e^{ 1 \frac{2 \cdot 0 \cdot \pi i}{ n} }, ..., e^{ (n - 1) \cdot  \frac{2 \cdot 0 \cdot  \pi i}{ n} } ), \\
    &amp;... \\
    &amp;e_{k - 1} = \frac{1}{\sqrt n} ( e^{ 0 \cdot \frac{2 \cdot (k - 1) \cdot  \pi i}{ n} }, e^{ 1 \frac{2 \cdot (k - 1) \cdot  \pi i}{ n} }, ..., e^{ (n - 1) \cdot \frac{2 \cdot (k - 1) \cdot  \pi i}{ n} } ), \\
    &amp;... \\
    &amp;e_{n - 1} = \frac{1}{\sqrt n} ( e^{ 0 \cdot \frac{2 \cdot (n - 1) \cdot  \pi i}{ n} }, e^{ 1 \frac{2 \cdot (n - 1) \cdot  \pi i}{ n} }, ..., e^{ (n - 1) \cdot \frac{2 \cdot (n - 1) \cdot  \pi i}{ n} } ).
\end{aligned}
\]</span></p>
<p>We use <span class="math inline">\(\mathcal{S}\)</span> to denote the linear span of <span class="math inline">\(e_0, e_1, ..., e_{n - 1}\)</span>.</p>
<h2 id="orthonormal-bases-verification">Orthonormal bases verification</h2>
<p>It is easy to see that <span class="math inline">\(e_k\)</span> is a unit vector, <span class="math inline">\(\forall k \in [0, n)\)</span>. The vectors in the bases are also mutually orthogonal, as for <span class="math inline">\(k, l \in [0, n), k \neq l\)</span>, <span class="math display">\[
    \left&lt; e_k, e_l \right&gt;_H = \sum_{j = 0 }^{n - 1} e^{ j \cdot \frac{ 2 (l - k) \pi i }{ n } } = \frac{ 1 - e^{ n \cdot \frac{ 2 (l - k) \pi i }{ n } } }{ 1 - e^{ \frac{ 2 (l - k) \pi i }{ n } } } = 0.
\]</span></p>
<h2 id="the-projection">The projection</h2>
<p>The projection of <span class="math inline">\(v\)</span> to the bases, is defined as the vector in the linear span of the bases that is closest to <span class="math inline">\(v\)</span>. It is given by <span class="math display">\[
    P(v) \doteq \sum_{k \in [0, n) } a_k e_k, 
\]</span></p>
<p>where <span class="math inline">\(a_k = \left&lt; e_k, v\right&gt;_H \doteq \bar e_k \cdot v\)</span>.</p>
<blockquote>
<p>Lemma. For any vector <span class="math inline">\(u\)</span> in <span class="math inline">\(S\)</span>, it holds that <span class="math display">\[
\left&lt; u, v \right&gt;_H = \left&lt; u, P(v) \right&gt;_H.
\]</span> Or, equivalently, <span class="math display">\[
\left&lt; u , v - P(v) \right&gt;_H = \left&lt; v - P(v), u \right&gt;_H = 0.
\]</span> <em>Proof:</em> Let <span class="math inline">\(u = \sum_{k \in [0, n) } c_k e_k : c_k \in \mathbb{C}, \forall k \in [0, n)\)</span> be a vector in <span class="math inline">\(\mathcal{S}\)</span>. As <span class="math inline">\(e_0, e_1, ..., e_{n - 1}\)</span> are mutually orthogonal, <span class="math display">\[
\left&lt; u, v \right&gt;_H = \sum_{k \in [0, n) } \bar c_k \cdot a_k =\left&lt; u, P(v) \right&gt;_H.
\]</span></p>
</blockquote>
<p>Next, we verify that <span class="math inline">\(P(v)\)</span> minimizes the distance to <span class="math inline">\(v\)</span>.</p>
<blockquote>
<p>Theorem. <span class="math display">\[
P(v) = \argmin_{w \in \mathcal{S} } ||u - w||^2.
\]</span> <em>Proof:</em> Let <span class="math inline">\(w = \sum_{k \in [0, n) } d_k e_k : d_k \in \mathbb{C}, \forall k \in [0, n)\)</span> and define <span class="math inline">\(u = P(v) - w\)</span>. Observe that <span class="math inline">\(u \in \mathcal{S}\)</span>. By the previous lemma, <span class="math display">\[
\begin{aligned}
|| v - w ||^2 
&amp;= || v - P(v) + P(v) - w ||^2 \\
&amp;= || v - P(v) ||^2 + ||P(v) - w||^2 + \left&lt; v - P(v), u \right&gt;_H + \left&lt; u, v - P(v) \right&gt;_H \\
&amp;= || v - P(v) ||^2 + ||P(v) - w||^2
\end{aligned}
\]</span> Hence, <span class="math inline">\(|| v - w ||^2\)</span> is minimized if and only if <span class="math inline">\(w = P(v)\)</span>.</p>
</blockquote>
<h2 id="matrix-form">Matrix Form</h2>
<p>The coefficients of <span class="math inline">\(a_0, a_1, ..., a_{n - 1}\)</span> can be given in matrix form: <span class="math display">\[
\begin{bmatrix}
    a_0 \\
    a_1 \\
    ... \\
    a_{n - 1}
\end{bmatrix} 
=
\begin{bmatrix}
    - \bar e_0 - \\
    ...\\
    - \bar e_k - \\
    ... \\
    - \bar e_{n - 1} - \\
\end{bmatrix} v 
=
\frac{1}{ \sqrt n }
\begin{bmatrix}
    e^{ -0 \cdot \frac{2 \cdot 0 \cdot  \pi i}{ n} }, e^{ -1 \frac{2 \cdot 0 \cdot  \pi i}{ n} }, ..., e^{ -(n - 1) \cdot  \frac{2 \cdot 0 \cdot  \pi i}{ n} } \\
    ...\\
    e^{ -0 \cdot \frac{2 \cdot (k - 1) \cdot \pi i}{ n} }, e^{ -1 \frac{2 \cdot (k - 1) \cdot \pi i}{ n} }, ..., e^{ -(n - 1) \cdot \frac{2 \cdot (k - 1) \cdot \pi i}{ n} } \\
    ... \\
    e^{ -0 \cdot \frac{2 \cdot (n - 1) \cdot \pi i}{ n} }, e^{ -1 \frac{2 \cdot (n - 1) \cdot \pi i}{ n} }, ..., e^{ -(n - 1) \cdot \frac{2 \cdot (n - 1) \cdot \pi i}{ n} }  \\
\end{bmatrix} v.
\]</span></p>
<p>Define the matrix <span class="math inline">\(M_n\)</span> as <span class="math display">\[
    M_n \doteq 
    \begin{bmatrix}
        e^{ -0 \cdot \frac{2 \cdot 0 \cdot  \pi i}{ n} }, e^{ -1 \frac{2 \cdot 0 \cdot  \pi i}{ n} }, ..., e^{ -(n - 1) \cdot  \frac{2 \cdot 0 \cdot  \pi i}{ n} } \\
        ...\\
        e^{ -0 \cdot \frac{2 \cdot (k - 1) \cdot \pi i}{ n} }, e^{ -1 \frac{2 \cdot (k - 1) \cdot \pi i}{ n} }, ..., e^{ -(n - 1) \cdot \frac{2 \cdot (k - 1) \cdot \pi i}{ n} } \\
        ... \\
        e^{ -0 \cdot \frac{2 \cdot (n - 1) \cdot \pi i}{ n} }, e^{ -1 \frac{2 \cdot (n - 1) \cdot \pi i}{ n} }, ..., e^{ -(n - 1) \cdot \frac{2 \cdot (n - 1) \cdot \pi i}{ n} }  \\
    \end{bmatrix}.
\]</span></p>
<p>The key result of this section is the following theorem.</p>
<blockquote>
<p>Theorem. An <span class="math inline">\(n\)</span>-dimension discrete Fourier transform can be performed in <span class="math inline">\(O(n \log n)\)</span> time. Equivalently, given <span class="math inline">\(v \in \mathbb{C}^n\)</span>, <span class="math inline">\(M_n v\)</span> can be computed in <span class="math inline">\(O(n \log n)\)</span> time.</p>
</blockquote>
<p>The underlying idea of the theorem is divide-and-conquer. Let <span class="math inline">\(T(n)\)</span> be the time of performing an <span class="math inline">\(n\)</span>-dimension discrete Fourier transform. We will prove the following recursion</p>
<blockquote>
<p><span class="math inline">\(T(n) = 2 \cdot T(n / 2) + O(n)\)</span>.</p>
</blockquote>
<p>We begin by a special case where <span class="math inline">\(n = 8\)</span>. As each entry in <span class="math inline">\(M_8\)</span> is complex number with unit length, we can represent it by a unit length vector, as the figure below shows.</p>
<p>There are some patterns in <span class="math inline">\(M_8\)</span> and it can be decomposed into 4 matrices related to <span class="math inline">\(M_4\)</span>.</p>
<p><em>Remark: I get this visualization idea from [1].</em></p>
<div style="text-align:center">
<p><img src="https://github.com/wuhao-wu-jiang/BlogImgs/blob/master/FastFourierTransformation/0.png?raw=true" width="400" height="400" /></p>
</div>
<p>First, look the the first half of the rows of <span class="math inline">\(M\)</span>, denoted as <span class="math inline">\(M_U\)</span>. The even columns constitute exactly the matrix <span class="math inline">\(M_4\)</span>. The odd columns forms a <span class="math inline">\(4 \times 4\)</span> matrix that can be obtained by proper rotations of <span class="math inline">\(M_4\)</span>.</p>
<p>Let <span class="math inline">\(v_e\)</span>, <span class="math inline">\(v_o\)</span> be the even and odd dimensions of <span class="math inline">\(v\)</span>, respectively. Then <span class="math display">\[
    M_U v = M_4 v_e + 
        \begin{bmatrix} 
           e^{ -\frac{2 \cdot 0 \cdot  \pi i}{ n} } \\
           e^{ -\frac{2 \cdot 1 \cdot  \pi i}{ n} } \\
           e^{ -\frac{2 \cdot 2 \cdot  \pi i}{ n} } \\
           e^{ -\frac{2 \cdot 3 \cdot  \pi i}{ n} }
        \end{bmatrix} \times M_4 v_0, 
\]</span></p>
<p>where <span class="math inline">\(\times\)</span> is element-wise multiplication between two vectors. This can also be replaced by matrix multiplication. <span class="math display">\[
    M_U v = M_4 v_e + 
        \text{diag} \left( 
                e^{ -\frac{2 \cdot 0 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 1 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 2 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 3 \cdot  \pi i}{ n} } \right)  M_4 v_0, 
\]</span></p>
<p>where <span class="math inline">\(\text{diag} \left( e^{ -\frac{2 \cdot 0 \cdot \pi i}{ n} }, e^{ -\frac{2 \cdot 1 \cdot \pi i}{ n} }, e^{ -\frac{2 \cdot 2 \cdot \pi i}{ n} }, e^{ -\frac{2 \cdot 3 \cdot \pi i}{ n} } \right)\)</span> denotes a <span class="math inline">\(4 \times 4\)</span>-diagonal matrix.</p>
<div style="text-align:center">
<p><img src="https://github.com/wuhao-wu-jiang/BlogImgs/blob/master/FastFourierTransformation/1.png?raw=true" width="400" height="400" /></p>
</div>
<p>First, look the the second half of the rows of <span class="math inline">\(M\)</span>, denoted as <span class="math inline">\(M_D\)</span>. The even columns constitute exactly the matrix <span class="math inline">\(M_4\)</span>, which is the same as the even columns of <span class="math inline">\(M_U\)</span>.</p>
<div style="text-align:center">
<p><img src="https://github.com/wuhao-wu-jiang/BlogImgs/blob/master/FastFourierTransformation/2.png?raw=true" width="400" height="400" /></p>
</div>
<p>For the odd columns of <span class="math inline">\(M_D\)</span>, they are in the opposite directions of the odds columns of <span class="math inline">\(M_U\)</span>. This can also be verified algebraically. An entry <span class="math inline">\(M_{k, l}\)</span> in the odd columns <span class="math inline">\(M_U\)</span> (<span class="math inline">\(k \in [0, n / 2)\)</span> and <span class="math inline">\(l\)</span> is odd) equals to <span class="math display">\[
    M_{k, l} = e^{ - l \cdot (k - 1) \cdot \frac{2 \cdot \pi \cdot i}{n} }.
\]</span></p>
<p>Its corresponding entry in <span class="math inline">\(M_D\)</span> is <span class="math display">\[
    M_{k + n / 2, l} = e^{ - l \cdot (k + n / 2- 1) \cdot \frac{2 \cdot \pi \cdot i}{n} } = e^{ - l \cdot (k - 1) \cdot \frac{2 \cdot \pi \cdot i}{n} } \cdot e^{ - l \cdot \pi \cdot i } = M_{k, l} \cdot (-1).
\]</span></p>
<p>The last equality holds since <span class="math inline">\(l\)</span> is odd.</p>
<p><em>Remark:</em> This also explains why <span class="math inline">\(M_{k + n / 2, l} = M_{k, l}\)</span> when <span class="math inline">\(l\)</span> is even.</p>
<div style="text-align:center">
<p><img src="https://github.com/wuhao-wu-jiang/BlogImgs/blob/master/FastFourierTransformation/3.png?raw=true" width="400" height="400" /></p>
</div>
<p>In summary, we have <span class="math display">\[
M v 
    =   \begin{bmatrix}
            M_U \\
            M_D
        \end{bmatrix} v
    =   \begin{bmatrix}
             M_{n / 2} v_e + 
        \text{diag} \left( 
                e^{ -\frac{2 \cdot 0 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 1 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 2 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 3 \cdot  \pi i}{ n} } \right)  M_{n / 2} v_0  \\
            M_{n / 2} v_e - 
        \text{diag} \left( 
                e^{ -\frac{2 \cdot 0 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 1 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 2 \cdot  \pi i}{ n} },
                e^{ -\frac{2 \cdot 3 \cdot  \pi i}{ n} } \right)  M_{n / 2} v_0
        \end{bmatrix}.
\]</span></p>
<p>And the Fast Fourier Transform algorithm is shown as below.</p>
<blockquote>
<p><strong>Algorithm FFT (Fast Fourier Transform).</strong><br />
<strong>Input.</strong> <span class="math inline">\(v \in \mathbb{C}^n\)</span>.<br />
1. If <span class="math inline">\(n = 1\)</span>, return <span class="math inline">\(v\)</span>.<br />
2. Compute <span class="math inline">\(r_e \leftarrow M_{n / 2} v_e\)</span> by <strong>FFT(<span class="math inline">\(v_e\)</span>)</strong>.<br />
3. Compute <span class="math inline">\(r_o \leftarrow M_{n / 2} v_o\)</span> by <strong>FFT(<span class="math inline">\(v_o\)</span>)</strong>.<br />
4. Return<br />
<span class="math display">\[
r \leftarrow  
\begin{bmatrix}
r_e +   
\text{diag} \left( 
e^{ -\frac{2 \cdot 0 \cdot  \pi i}{ n} },
e^{ -\frac{2 \cdot 1 \cdot  \pi i}{ n} },
e^{ -\frac{2 \cdot 2 \cdot  \pi i}{ n} },
e^{ -\frac{2 \cdot 3 \cdot  \pi i}{ n} } \right)  r_o \\
r_e -   
\text{diag} \left( 
e^{ -\frac{2 \cdot 0 \cdot  \pi i}{ n} },
e^{ -\frac{2 \cdot 1 \cdot  \pi i}{ n} },
e^{ -\frac{2 \cdot 2 \cdot  \pi i}{ n} },
e^{ -\frac{2 \cdot 3 \cdot  \pi i}{ n} } \right)  r_o
\end{bmatrix}.
\]</span></p>
</blockquote>
<p>Both step 2 and 3 have time <span class="math inline">\(T(n / 2)\)</span>. Step 4 aggregates the results and has time <span class="math inline">\(O(n)\)</span>, which implies that <span class="math display">\[
    T(n) = 2 \cdot T(n / 2) + O(n). 
\]</span></p>
<h3 id="reference">Reference</h3>
<p>[1] T. Roughgarden and G. Valiant, “CS168: The Modern Algorithmic Toolbox Lecture #15 and #16: The Fourier Transform and Convolution,” p. 12.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/12/Fourier-Transformation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/12/Fourier-Transformation/" class="post-title-link" itemprop="url">Fourier Transformation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-12 16:21:21" itemprop="dateCreated datePublished" datetime="2021-01-12T16:21:21+11:00">2021-01-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-04 22:45:51" itemprop="dateModified" datetime="2021-02-04T22:45:51+11:00">2021-02-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Let <span class="math inline">\(f: [-\pi, \pi]: \rightarrow \mathbb{R}\)</span> be a real function. As <span class="math inline">\(f\)</span> itself can be complicated, we want to decompose it into a linear combination of simpler functions.</p>
<blockquote>
<p><strong>Example.</strong> A typical family of simple functions are polynomials: <span class="math display">\[
\{ 1, t, t^2, t^3, ... \}.
\]</span> Under proper condition, e.g., if <span class="math inline">\(f\)</span> is infinitely differentiable, it can be indeed decomposed into a linear combination of polynomials, such as: <span class="math display">\[
f = f(0) + f&#39;(0)  t + \frac{f&#39;&#39;(t)}{2!} t^2 + ...
\]</span></p>
</blockquote>
<h2 id="problem"><strong>Problem</strong></h2>
<p>Here we study the problem of approximating <span class="math inline">\(f\)</span> with trigonometric functions: <span class="math display">\[
    \mathfrak{T} = \{ 1, \sin t, \cos t, \sin 2t, \cos 2t, .... \}.
\]</span></p>
<p>Although <span class="math inline">\(f: [-\pi, \pi]: \rightarrow \mathbb{R}\)</span> is a function with output on <span class="math inline">\(\mathbb{R}\)</span>, we view it as a function <span class="math inline">\([-\pi, \pi]: \rightarrow \mathbb{C}\)</span> to take advantage of complex exponential. Now, we approximate <span class="math inline">\(f\)</span> with a set of sinusoids: <span class="math display">\[
   \Gamma = \{ 1, \exp(it), \exp(-it), \exp(i2t), \exp(-i2t), \exp(i3t), \exp(-i3t)... \}.
\]</span></p>
<p>Observe that <span class="math inline">\(\Gamma\)</span> generalizes <span class="math inline">\(\mathfrak{T}\)</span>, as for <span class="math inline">\(\forall k \in \mathbb{N}\)</span>, <span class="math display">\[
2 \cos kt =  \exp(ikt) + \exp(-ikt), \\
2 \sin kt =  \exp(ikt) - \exp(-ikt). 
\]</span></p>
<p>Define the span <span class="math inline">\(S(\Gamma)\)</span> as the set of all possible linear combinations of functions in <span class="math inline">\(\Gamma\)</span>: <span class="math display">\[
S(\Gamma) \doteq \left\{ \sum_{k \in \mathbb{Z} } c_k \exp(ikt) : \forall k \in \mathbb{Z}, c_k \in \mathbb{C} \right\}.
\]</span></p>
<p><strong><em>The goal is to find the closest function to <span class="math inline">\(f\)</span> in <span class="math inline">\(S(\Gamma)\)</span></em></strong>.</p>
<p>The key issues with the approximation are</p>
<ol type="1">
<li><p>How do we measure the closeness between two functions?</p></li>
<li><p>Under what condition, can <span class="math inline">\(f\)</span> be rewrite as a linear combination of functions in <span class="math inline">\(\Gamma\)</span>?</p></li>
<li><p>What is the approximation error, between <span class="math inline">\(f\)</span> and the linear combination?</p></li>
</ol>
<h2 id="norm"><strong>Norm</strong></h2>
<p>Despite the goal stated above, the closeness between <span class="math inline">\(f\)</span> and a function in <span class="math inline">\(S(\Gamma)\)</span> has not yet been defined. This raises the question of measuring the distance between two functions in <span class="math inline">\([-\pi, \pi] \rightarrow \mathcal{C}\)</span>.</p>
<p>In <span class="math inline">\(\mathbb{R}^n\)</span>, the Euclidean distance between two vectors <span class="math inline">\(u, v\)</span> is defined as <span class="math display">\[
    || u - v || = \sqrt{\sum_{i = 1}^n (u_i - v_i)^2 }.
\]</span></p>
<p>If we define <span class="math inline">\(w = u - v\)</span>, then the problem of measuring the distance between two vectors reduces to the one of measuring the length of a vector <span class="math display">\[
|| u - v || = || w || = \sqrt{\sum_{i = 1}^n w_i^2 }.
\]</span></p>
<!-- We call the function $||\cdot || : \mathbb{R}^n \rightarrow \mathbb{R}$ as norm and it satisfies the following three properties:

1. Positive-definite: $||w|| = 0 \rightarrow w = 0, \forall w \in \mathbb{R}^n$;
2. Absolutely homogeneous: $|| a w|| = |a| \cdot ||w||, \forall a \in \mathbb{R}, \forall w \in \mathbb{R}^n$; 
3. Triangle inequality: $||w + w'|| \le ||w|| + ||w'||, \forall w, w' \in \mathbb{R}^n$. -->
<p>In a similar manner, if we view a function <span class="math inline">\(h: [-\pi, \pi] \rightarrow \mathcal{C}\)</span> as an (uncountable) infinite dimension vector, it is natural to defined its length <span class="math display">\[
    || h || \doteq \sqrt{ \int_{ [-\pi, \pi] }   ||h(t) ||^2 } = \sqrt{ \int_{ [-\pi, \pi] }   \overline{h(t) } \cdot h(t)  }.
\]</span></p>
<blockquote>
<p><em>Remark:</em> 1. <em><span class="math inline">\(|| h ||^2\)</span> needs to be integrable.</em><br />
2. <em>Verify that <span class="math inline">\(|| \cdot ||\)</span> is a norm.</em></p>
</blockquote>
<p>As <span class="math inline">\(f - g\)</span> is also a function in <span class="math inline">\([-\pi, \pi] \rightarrow \mathcal{C}\)</span>, the distance between two functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> is given by <span class="math display">\[
\begin{aligned}
    ||f - g|| 
        &amp;= \sqrt{ \int_{ [-\pi, \pi] }   ||f(t) - g(t)||^2  } \\
        &amp;= \sqrt{ \int_{ [-\pi, \pi] }   \overline{ (f(t) - g(t) ) } \cdot (f(t) - g(t) )  } \\
        &amp;= \sqrt{ \int_{ [-\pi, \pi] }   \overline{ f(t) } \cdot f(t) + \int_{ [-\pi, \pi] }  \overline{ g(t) } \cdot g(t) - \int_{ [-\pi, \pi] }  \overline{ f(t) } \cdot g(t) - \int_{ [-\pi, \pi] }  \overline{ g(t) } \cdot f(t) \   } \\
        &amp;= \sqrt{ ||f||^2 + || g ||^2 - \int_{ [-\pi, \pi] }  \overline{ f(t) } \cdot g(t) - \int_{ [-\pi, \pi] }  \overline{ g(t) } \cdot f(t) \   }. \\
\end{aligned}
\]</span></p>
<blockquote>
<p><em>Remark:</em> 1. <span class="math inline">\(|| f - g ||^2\)</span> needs to be integrable. 2. The integration operation is required to be linear.</p>
</blockquote>
<h3 id="hermitian-product"><strong>Hermitian Product</strong></h3>
<p>To simplify the expansion of <span class="math inline">\(||f - g||\)</span>, we introduce another operation, termed Hermitian product, as follows: <span class="math display">\[
\left&lt; g, f \right&gt;_H \doteq \int_{ [-\pi, \pi] }  \overline{ g(t) } \cdot f(t).
\]</span></p>
<p>The operation is not symmetric. By definition, <span class="math display">\[
\left&lt; f, g \right&gt;_H \doteq \int_{ [-\pi, \pi] }  \overline{ f(t) } \cdot g(t).
\]</span></p>
<p><span class="math inline">\(\left&lt; g, f \right&gt;_H\)</span> is the complex conjugate of <span class="math inline">\(\left&lt; f, g \right&gt;_H\)</span>: <span class="math display">\[
\left&lt; g, f \right&gt;_H = \overline{ \left&lt; f, g \right&gt;_H }.
\]</span></p>
<p>For any <span class="math inline">\(c \in \mathbb{C}\)</span>, it holds that <span class="math display">\[
\left&lt; c \cdot g, f \right&gt;_H = \bar c \cdot \left&lt; g, f \right&gt;_H,  \\
\left&lt; g, c \cdot f \right&gt;_H = c  \cdot \left&lt; g, f \right&gt;_H. \\
\]</span></p>
<p>Now the expansion of <span class="math inline">\(||f - g||\)</span> is simplified as <span class="math display">\[
\begin{aligned}
    ||f - g|| 
        &amp;= \sqrt{ ||f||^2 + ||g||^2 - ( \overline{ \left&lt; g, f \right&gt;_H } + \left&lt; g, f \right&gt;_H ) } \\
        &amp;= \sqrt{ ||f||^2 + ||g||^2 - 2 \cdot \mathbb{Re}( \left&lt; g, f \right&gt;_H ) }. \\
\end{aligned}
\]</span></p>
<h4 id="geometric-interpretation"><strong>Geometric Interpretation</strong></h4>
<p>We have just introduced the notation of Hermitian product to simplify the expression. Its "geometric" interpretation is related to the idea of "projection". We start by reviewing the ideas of "Projection, Dot Product and Orthogonality" in <span class="math inline">\(\mathbb{R}^2\)</span>.</p>
<blockquote>
<p><strong>Projection</strong> in <span class="math inline">\(\mathbb{R}^2\)</span>. Given <span class="math inline">\(u, v \in \mathbb{R}^2\)</span>, the projection of <span class="math inline">\(u\)</span> to <span class="math inline">\(v\)</span> is the vector in the subspace <span class="math display">\[
S(v) \doteq \{ c \cdot v : c \in \mathbb{R} \}
\]</span> that is closest to <span class="math inline">\(u\)</span>.</p>
<p><strong>Dot Product</strong> in <span class="math inline">\(\mathbb{R}^2\)</span>. Given <span class="math inline">\(u, v \in \mathbb{R}^2\)</span>, their dot product is defined as <span class="math display">\[
\left&lt; u, v \right&gt; = u_1 v_1 + u_2 v_2.
\]</span> The projection of <span class="math inline">\(u\)</span> to <span class="math inline">\(v\)</span> (closest vector to <span class="math inline">\(u\)</span> in <span class="math inline">\(S(v)\)</span>) is given by <span class="math display">\[
\frac{1}{ ||v||^2 } \left&lt; u, v \right&gt; \cdot v = \frac{ \left&lt; u, v \right&gt; }{ ||v|| }  \cdot \frac{ v }{ ||v|| }.
\]</span> The first term of the final product <span class="math inline">\(\frac{ \left&lt; u, v \right&gt; }{ ||v|| } = \frac{ ||u|| \cdot ||v|| \cdot \cos \angle (u, v) }{ ||v|| } = ||u|| \cdot \cos \angle (u, v)\)</span> gives the length of <span class="math inline">\(u\)</span>'s projection to <span class="math inline">\(v\)</span>, and the second term <span class="math inline">\(\frac{ v }{ ||v|| }\)</span> is a unit vector that shares the same direction as <span class="math inline">\(v\)</span>.</p>
<p><strong>Orthogonality</strong> in <span class="math inline">\(\mathbb{R}^2\)</span>. Given <span class="math inline">\(u, v \in \mathbb{R}^2\)</span>, they are orthogonal if the projection of <span class="math inline">\(u\)</span> to <span class="math inline">\(v\)</span> is <span class="math inline">\(\vec 0\)</span>. In this case, <span class="math display">\[
\left&lt; u, v \right&gt; = 0.
\]</span></p>
</blockquote>
<p>We can extend these ideas to <span class="math inline">\([-\pi, \pi] \rightarrow \mathbb{C}\)</span>.</p>
<h4 id="projection"><strong>Projection</strong></h4>
<p>Given <span class="math inline">\(f, g:[-\pi, \pi] \rightarrow \mathcal{C}\)</span>, the projection of <span class="math inline">\(f\)</span> to <span class="math inline">\(g\)</span> is the function in the linear span of <span class="math inline">\(g\)</span> <span class="math display">\[
    S(g) \doteq \{ c \cdot g : c \in \mathbb{C} \}
\]</span> that minimize <span class="math inline">\(||f - c \cdot g||, \forall c \in \mathbb{C}\)</span>.</p>
<h4 id="hermitian-product-1"><strong>Hermitian Product</strong></h4>
<p>Hermitian product is related to projection and arises naturally when we try to solve <span class="math display">\[
    \min_{c \in \mathbb{C} }  ||f - c \cdot g||,
\]</span></p>
<p>or equivalently, <span class="math display">\[
    \min_{c \in \mathbb{C} }  ||f - c \cdot g||^2.
\]</span></p>
<p>Expanding <span class="math inline">\(||f - c \cdot g||^2\)</span> and let <span class="math inline">\(c = x + iy\)</span>, <span class="math inline">\(\left&lt; g, f \right&gt;_H = a + i b\)</span>, we get <span class="math display">\[
\begin{aligned}
    ||f - c \cdot g||^2  
        &amp;= ||f||^2 + ||c||^2 \cdot ||g||^2 -  2 \cdot \mathbb{Re}( \left&lt; c \cdot g, f \right&gt;_H )  \\
        &amp;= ||f||^2 + ||c||^2 \cdot ||g||^2 - 2 \cdot \mathbb{Re} ( \bar c \cdot \left&lt; g, f \right&gt;_H ) \\
        &amp;= ||f||^2 + (x^2 + y^2) \cdot ||g||^2 - 2 \cdot \mathbb{Re} ( ( x- i y)  \cdot (a + i b) ) \\
        &amp;= ||f||^2 + (x^2 + y^2) \cdot ||g||^2 - 2 \cdot (a x + by) \\
\end{aligned}
\]</span></p>
<blockquote>
<p><em>Remark:</em> <em>The derivation above requires the integration operation to be linear.</em></p>
</blockquote>
<p>Taking the derivate of RHS with respect to <span class="math inline">\(x\)</span>, setting it to zero and assuming that <span class="math inline">\(||g|| \neq 0\)</span>, we see <span class="math display">\[
    2x\cdot ||g||^2 - 2 a = 0 \Rightarrow x = \frac{ a }{ ||g||^2 }.
\]</span></p>
<p>Similarly, <span class="math display">\[
    2y\cdot ||g||^2 - 2 b = 0 \Rightarrow y = \frac{ b }{ ||g||^2 }.
\]</span></p>
<p>Combined, <span class="math inline">\(c\)</span> is given by <span class="math display">\[
    c = x + iy = \frac{ \left&lt; g, f \right&gt;_H  }{ ||g||^2 } = \left&lt; \frac{g }{ ||g|| }, f \right&gt;_H \cdot \frac{ 1 }{ ||g|| }.
\]</span></p>
<p>This implies that <span class="math display">\[
    c \cdot g = \frac{ \left&lt; g, f \right&gt;_H  }{ ||g||^2 } \cdot g = \left&lt; \frac{g }{ ||g|| }, f \right&gt;_H \cdot \frac{g }{ ||g|| }.
\]</span></p>
<p>Now it is clear that the Hermitian product computes the coefficient for the projection of <span class="math inline">\(f\)</span> to <span class="math inline">\(g\)</span>, scaled by a factor of <span class="math inline">\(1/ ||g||^2\)</span>. When <span class="math inline">\(|| g ||\)</span> has unit length, <span class="math display">\[  
    c \cdot g = \left&lt; g, f \right&gt;_H \cdot g.
\]</span></p>
<p>The Hermitian product <span class="math inline">\(\in \mathbb{C}\)</span> is the just the coefficient for the projection.</p>
<h4 id="orthogonality"><strong>Orthogonality</strong></h4>
<p>Given <span class="math inline">\(f, g:[-\pi, \pi] \rightarrow \mathcal{C}\)</span>, <span class="math inline">\(f\)</span> is orthogonal to <span class="math inline">\(g\)</span> if the projection of <span class="math inline">\(f\)</span> to <span class="math inline">\(g\)</span> is the zero function, i.e., the closest function (measured by <span class="math inline">\(|| \cdot ||\)</span>) to <span class="math inline">\(f\)</span> in the linear span <span class="math inline">\(S(g)\)</span> is the constant function zero. It holds that, either <span class="math inline">\(||g||^2 = 0\)</span> or <span class="math display">\[
    \arg\min_{ c \in \mathbb{C} } \left| \left|f - c \cdot g \right| \right|^2 = \frac{ \left&lt; g, f \right&gt;_H  }{ ||g||^2 } = 0.
\]</span></p>
<p>In both cases, <span class="math display">\[
    \overline{ \left&lt; g, f \right&gt;_H } = \left&lt; f, g \right&gt;_H = 0.
\]</span></p>
<h2 id="properties-of-gamma"><strong>Properties of <span class="math inline">\(\Gamma\)</span></strong></h2>
<p>We are now ready to discuss the properties of <span class="math inline">\(\Gamma = \{ 1, \exp(it), \exp(-it), \exp(i2t), \exp(-i2t), ... \}\)</span>. 1. For <span class="math inline">\(k \in \mathbb{Z}\)</span>, <span class="math display">\[
   || \exp(ikt) || = \sqrt{ \int_{ [-\pi, \pi] }  \overline{\exp(ikt) } \exp(ikt) \  } = \sqrt{2 \pi }.
   \]</span></p>
<ol start="2" type="1">
<li>For <span class="math inline">\(k, l \in \mathbb{Z}\)</span>, <span class="math inline">\(k \neq l\)</span>, <span class="math inline">\(\exp(ikt)\)</span> and <span class="math inline">\(\exp(ilt)\)</span> are orthogonal. <span class="math display">\[
\begin{aligned}
    \left&lt; \exp(ikt), \exp(ilt) \right&gt;_H 
     &amp;= \int_{ [ -\pi, \pi] } \exp(-ikt) \cdot \exp(ilt)  \\
     &amp;= \int_{ [ -\pi, \pi] } \exp(i (l - k) t) \\
     &amp;= \frac{1}{ i(l - k) } \exp(i (l - k) t) \mid_{- \pi}^\pi \\
     &amp;= 0.
\end{aligned}
\]</span></li>
</ol>
<p>If we normalize the function in <span class="math inline">\(\Gamma\)</span> by <span class="math inline">\(1 / \sqrt{2 \pi}\)</span>, then each function has norm 1. We call this family an orthonormal family, and rewrite it as <span class="math display">\[
\mathfrak{F} = \{ e_0,  e_1, e_2, e_3, ..., \},
\]</span></p>
<p>where <span class="math inline">\(e_0 = 1\)</span>, and for <span class="math inline">\(k \in \mathbb{N}\)</span>,</p>
<ul>
<li><p><span class="math inline">\(e_{2k + 1} = \exp(ikt) / \sqrt{2 \pi}\)</span>;</p></li>
<li><p><span class="math inline">\(e_{2k + 2} = \exp(- ikt) / \sqrt{2 \pi}\)</span>.</p></li>
</ul>
<h2 id="approximating-f-with-mathfrakf"><strong>Approximating <span class="math inline">\(f\)</span> with <span class="math inline">\(\mathfrak{F}\)</span></strong></h2>
<p>As discuss before, we have construct an orthogonal family of <span class="math inline">\(\mathfrak{F}\)</span>, such that</p>
<ol type="1">
<li><span class="math inline">\(||e_i|| = 1\)</span> for <span class="math inline">\(e_i \in \mathfrak{F}\)</span>.</li>
<li><span class="math inline">\(\left&lt; e_i, e_j \right&gt;_H = 0\)</span> for <span class="math inline">\(e_i, e_j \in \mathfrak{F}, e_i \neq e_j\)</span>.</li>
</ol>
<!-- We continue to study the following two questions. 

2. Under what condition, can $f$ be rewrite as a linear combination of functions in $\mathfrak{F}$?
   
3. What is the approximation error, between $f$ and the linear combination?

For the second question, we provide a sufficient condition as an answer:

> $f^2$ is integrable. 

Hence,  -->
<p><strong>Definition.</strong> Define <span class="math inline">\(S(\mathfrak{F}_k)\)</span> the span of the first <span class="math inline">\(k + 1\)</span> elements in <span class="math inline">\(\mathfrak{F}\)</span>: <span class="math display">\[
    S(\mathfrak{F}_k ) \doteq \left\{ \sum_{i = 0}^k c_i \cdot e_i : \forall \ 0 \le i \le k, c_i \in \mathbb{C} \right\}. 
\]</span></p>
<blockquote>
<p><strong>Theorem.</strong> The closest function to <span class="math inline">\(f\)</span> in <span class="math inline">\(S(\mathfrak{F}_k )\)</span>, denoted as <span class="math inline">\(g_k\)</span>, is given by <span class="math display">\[
    g_k \doteq \sum_{i = 0 }^k a_i \cdot e_i.
\]</span> where <span class="math inline">\(a_i \doteq \left&lt; e_i, f \right&gt;_H, 0 \le i \le k\)</span>.</p>
</blockquote>
<blockquote>
<p><em>Remark: implicitly, we assume that <span class="math inline">\(f^2\)</span>, <span class="math inline">\(\bar e_i f\)</span> is integrable.</em></p>
</blockquote>
<p><em>Proof:</em> For <span class="math inline">\(0 \le i \le k\)</span>, it holds that <span class="math display">\[
\left&lt; e_i, g_k \right&gt;_H = \sum_{j = 0 }^k \left&lt; e_i, a_j \cdot e_j \right&gt;_H =  a_i = \left&lt; e_i, f \right&gt;_H.
\]</span></p>
<p>Hence, <span class="math display">\[
\left&lt; e_i, g_k - f\right&gt;_H = \overline{ \left&lt; g_k - f, e_i \right&gt;_H  } = 0. 
\]</span></p>
<p>Let <span class="math display">\[
    f_k = \sum_{i = 0}^k c_i \cdot e_i, 
\]</span></p>
<p>be a function in <span class="math inline">\(S(\mathfrak{F}_k )\)</span>. Then, <span class="math display">\[
\begin{aligned}
    || f - f_k||^2 
        &amp;= ||f - g_k + g_k - f_k ||^2 \\
        &amp;= ||f - g_k||^2 + ||g_k - f_k||^2 + \left&lt; f - g_k, g_k - f_k\right&gt;_H + \left&lt; g_k - f_k, f - g_k \right&gt;_H. 
\end{aligned}
\]</span></p>
<p>It holds that <span class="math display">\[
\left&lt; f - g_k, g_k - f_k\right&gt;_H = \sum_{i = 0}^k (a_i - c_i) \cdot \left&lt; f - g_k,  e_i \right&gt;_H = 0.
\]</span></p>
<p>Similarly, <span class="math inline">\(\left&lt; g_k - f_k, f - g_k \right&gt;_H = 0\)</span>. So, <span class="math display">\[
\begin{aligned}
    || f - f_k||^2 
        &amp;= ||f - g_k||^2 + ||g_k - f_k||^2,  
\end{aligned}
\]</span></p>
<p>which is minimized when <span class="math inline">\(f_k = g_k\)</span>.</p>
<p><span class="math inline">\(\square\)</span></p>
<!-- $$
\begin{aligned}
    ||f - f_k||^2 
        &= \left< f - f_k, f - f_k \right>_H \\
        &= \left<  f, f\right>_H + \left<  f_k, f_k \right>_H - \left<  f, f_k \right>_H - \left<  f_k , f\right>_H \\
        &= ||f||^2 + \sum_{i = 0}^k \left( \left< c_i \cdot e_i, c_i \cdot e_i \right>_H - \left<  f, c_i \cdot e_i \right>_H - \left< c_i \cdot e_i , f \right>_H \right) \\
        &= ||f||^2 + \sum_{i = 0}^k \left( \bar c_i \cdot c_i - c_i \cdot \left<  f, e_i \right>_H - \bar c_i \cdot \left< e_i , f \right>_H + \bar a_i \cdot a_i \right) - \sum_{i = 0}^k ||a_i||^2 \\
        &= ||f||^2 + \sum_{i = 0}^k \left( \bar c_i \cdot c_i - c_i \cdot \bar a_i - \bar c_i \cdot a_i + \bar a_i \cdot a_i \right) - \sum_{i = 0}^k ||a_i||^2 \\
        &= ||f||^2 + \sum_{i = 0}^k ||c_i - a_i||^2 - \sum_{i = 0}^k ||a_i||^2. \\
\end{aligned}
$$ -->
<!-- Thus, when $c_i = a_i$, the distance between $f_k$ and $f$ is minimized.  -->
<blockquote>
<p><strong>Corollary. (Bessel Ineuqality)</strong>. <span class="math display">\[
\sum_{i = 0}^\infty ||a_i||^2 \le ||f||^2.
\]</span></p>
</blockquote>
<p><em>Proof.</em> We see that <span class="math display">\[
\begin{aligned}
    || f - g_k ||^2 
        &amp;= \left&lt; f - g_k, f \right&gt;_H - \left&lt; f - g_k, g_k \right&gt;_H \\
        &amp;= \left&lt; f , f \right&gt;_H - \left&lt;  g_k, f \right&gt;_H \\
        &amp;= ||f||^2 - \sum_{i = 0}^k ||a_i||^2 \\
        &amp;\ge 0.
\end{aligned}
\]</span></p>
<p>Therefore, <span class="math display">\[
    \sum_{i = 0}^k ||a_i||^2 \le ||f||^2.
\]</span></p>
<p>Taking the limit of <span class="math inline">\(k\)</span> we get the desired result.</p>
<p><span class="math inline">\(\square\)</span></p>
<p>The function series <span class="math inline">\(g_1, g_2, g_3, ...\)</span> is called a Cauchy series, as <span class="math inline">\(\forall \epsilon &gt; 0\)</span>, <span class="math inline">\(\exists N \ge 0\)</span>, <span class="math inline">\(\forall N \le i &lt; j\)</span>, it holds that <span class="math display">\[
    ||g_j - g_i|| = || \sum_{t = i + 1}^j a_t \cdot e_t ||
    = \sqrt{ \sum_{t = i + 1}^j ||a_t||^2 } \le \epsilon.
\]</span></p>
<p>Suppose that we are using some kind of integration and let <span class="math inline">\(I^2([-\pi, \pi])\)</span> be the set of square integrable functions. Further, assume that <span class="math inline">\(g_1, g_2, g_3, ...\)</span> are also elements in <span class="math inline">\(I^2([-\pi, \pi])\)</span>. We are interested in</p>
<blockquote>
<p>Whether a Cauchy series in <span class="math inline">\(I^2([-\pi, \pi])\)</span> converges to a function in <span class="math inline">\(I^2([-\pi, \pi])\)</span>?</p>
</blockquote>
<p>Define <span class="math display">\[
    g = \lim_{k \rightarrow \infty} g_k = \sum_{i = 0}^\infty a_i \cdot e_i.
\]</span></p>
<p>It is important that <span class="math inline">\(g \in I^2([-\pi, \pi])\)</span>, as we need the length of <span class="math inline">\(|| g ||\)</span> to be well-defined. Further, <span class="math inline">\(f - g\)</span> should also be in <span class="math inline">\(I^2([-\pi, \pi])\)</span>.</p>
<p>However, if we are using Riemann integration, the answer is no. Let <span class="math inline">\(r_1, r_2, ....\)</span> be the rational number in the interval of <span class="math inline">\([0, 1]\)</span> and define <span class="math display">\[
    h_i(x) = \begin{cases}
        \begin{aligned}
            &amp;1,  &amp;\text{if } x \in \cup_{t = 1}^i \{ r_t \} \\
            &amp;0,  &amp;\text{otherwise}
        \end{aligned}
    \end{cases}
\]</span></p>
<p>Then <span class="math inline">\(h_i \in I^2([-\pi, \pi])\)</span> but <span class="math inline">\(\lim_{i \rightarrow \infty} h_i\)</span> is not Riemann integrable, hence not in <span class="math inline">\(I^2([-\pi, \pi])\)</span>.</p>
<p>If we are using Lebesgue integration, the answer is yes.</p>
<blockquote>
<p>Fact. If we are using Lebesgue integration, then <span class="math inline">\(I^2([-\pi, \pi])\)</span> is complete, i.e., if <span class="math inline">\(g_1, g_2, ..., \in I^2([-\pi, \pi])\)</span> is Cauchy, then <span class="math inline">\(\lim_k g_k \in I^2([-\pi, \pi])\)</span>.</p>
</blockquote>
<h2 id="approximating-error"><strong>Approximating Error</strong></h2>
<p>It is left to study the error of approximating <span class="math inline">\(f\)</span> with <span class="math inline">\(g\)</span>.</p>
<blockquote>
<p><strong>Lemma. Cauchy-Schwartz Inequality.</strong> Let <span class="math inline">\(h_1, h_2 \in I^2([-\pi, \pi])\)</span>, then <span class="math display">\[
| \left&lt; h_1, h_2 \right&gt;_H | \le ||h_1|| \cdot ||h_2 ||
\]</span></p>
</blockquote>
<p><em>Proof.</em> If <span class="math inline">\(||h_2|| = 0\)</span>, then <span class="math inline">\(h_2 = 0\)</span> almost everywhere and the case is trivial. Otherwise, <span class="math inline">\(\forall c \in \mathbb{C}\)</span>, we have <span class="math display">\[
\begin{aligned}
    || h_1 - c \cdot h_2 ||^2 
        &amp;= || h_1||^2 + ||c||^2 ||h_2||^2 -  \left&lt; h_1, c \cdot h_2 \right&gt;_H -   \left&lt; c \cdot h_2, h_1 \right&gt;_H \\
        &amp;= || h_1||^2 + ||c||^2 ||h_2||^2 - c \cdot \left&lt; h_1, h_2 \right&gt;_H - \bar c \cdot \left&lt; h_2, h_1 \right&gt;_H \\
\end{aligned}
\]</span></p>
<p>Let <span class="math inline">\(c = \frac{1}{ ||h_2||^2 } \cdot \left&lt; h_2, h_1 \right&gt;_H\)</span>, then <span class="math display">\[
\begin{aligned}
    || h_1 - c \cdot h_2 ||^2 
        &amp;= || h_1||^2 - \frac{1}{ ||h_2||^2 } \cdot \left| \left&lt; h_2, h_1 \right&gt;_H \right|^2 
        &amp;\ge 0.
\end{aligned}
\]</span></p>
<!-- As  -->
<!-- $$
    || \left< h_1, h_2 \right>_H || \le ||h_1|| \cdot ||h_2 || \longleftrightarrow
    \left|\left| \left< \frac{h_1}{ ||h_1|| }, \frac{h_2}{ ||h_2 || } \right>_H \right|\right| \le  1
$$

Without lose of generality, we assume that $||h_1|| = 1$ and $||h_2|| = 1$. 

$$
\begin{aligned}
    2 \cdot \mathbb{Re} \left( \left< h_1, h_2 \right>_H \right) 
        &= \left< h_1, h_2 \right>_H  + \overline{ \left< h_2, h_1 \right>_H } \\
        &= \int_{ [ -\pi, \pi] } \bar h_1 h_2  + \bar h_2 h_1 \\
        &\le \int_{ [ -\pi, \pi] } 2 \left( ||h_1||^2 + ||h_2||^2 \right)
\end{aligned}
$$ -->
<!-- We will prove that 
$$
    || \left< h_1, h_2 \right>_H ||^2 \le 1.
$$

$$
    \begin{aligned}
        \left|\left| \int_{ [ -\pi, \pi] } \bar h_1 h_2 \right|\right|^2 
        &= \left|\left| \int_{ [ -\pi, \pi] } \mathbb{Re} (\bar h_1 h_2) + i \mathbb{Im} (\bar h_1 h_2) \right|\right|^2 \\
        &= \left( \int_{ [ -\pi, \pi] } \mathbb{Re} (\bar h_1 h_2) \right)^2 +  \left( \int_{ [ -\pi, \pi] } \mathbb{Im} (\bar h_1 h_2) \right)^2 \\
        &\le \left( \int_{ [ -\pi, \pi] } \mathbb{Re} (\bar h_1 h_2) \right)^2 +  \left( \int_{ [ -\pi, \pi] } \mathbb{Im} (\bar h_1 h_2) \right)^2
    \end{aligned}
$$ -->
<p><span class="math inline">\(\square\)</span></p>
<blockquote>
<p><strong>Lemma.</strong> <span class="math inline">\(\forall i \in \mathbb{N}\)</span>, <span class="math inline">\(\left&lt; e_i, g \right&gt;_H =a_i\)</span>.</p>
</blockquote>
<p><em>Proof.</em> By Cauchy-Schwartz inequality,</p>
<p><span class="math display">\[
\begin{aligned}
    \left|\left| \int_{ [ -\pi, \pi] } \bar e_i (g_k - g) \right|\right|^2
        &amp;\le \left( \int_{ [ -\pi, \pi] } ||e_i||^2 \right) \cdot \left( \int_{ [ -\pi, \pi] } ||g_k - g||^2 \right) \\
        &amp;= \int_{ [ -\pi, \pi] } ||g_k - g||^2 \\
        &amp;= \int_{ [ -\pi, \pi] } \lim_l ||g_k - g_l ||^2 
\end{aligned}
\]</span></p>
<p>By <strong>Fatou's lemma</strong>, <span class="math display">\[
    \int_{ [ -\pi, \pi] } \lim_l ||g_k - g_l ||^2 \le \liminf_l \int_{ [ -\pi, \pi] } ||g_k - g_l ||^2 
\]</span></p>
<p>Finally, <span class="math display">\[
    \lim_k  \left|\left|  \left&lt;  e_i, g_k - g \right&gt;_H \right|\right|^2 = \lim_k \left|\left|  \int_{ [ -\pi, \pi] } \bar e_i (g_k - g) \right|\right|^2 \le \lim_k \liminf_l \int_{ [ -\pi, \pi] } ||g_k - g_l ||^2  = 0.
\]</span></p>
<p><span class="math inline">\(\square\)</span></p>
<blockquote>
<p>Remark: the above proof involves the operation of exchanging the order of two limiting operations, namely <span class="math inline">\(\lim\)</span> and <span class="math inline">\(\int\)</span>. Exchanging order like this is dangerous for Riemann integration, but we can do it safely under Lebesgue integration, under proper condition. Here we use <strong>Fatou's lemma</strong>.</p>
</blockquote>
<p>By the above lemma, the function <span class="math inline">\(g\)</span> has an important property, such that <span class="math inline">\(\forall i \in \mathbb{N}\)</span>, <span class="math display">\[
    \left&lt; e_i, f - g \right&gt;_H = 0.
\]</span></p>
<blockquote>
<p><strong>Lemma.</strong> Let <span class="math inline">\(h \in I^2([-\pi, \pi])\)</span>. If <span class="math inline">\(\forall i \in N\)</span>, <span class="math display">\[
\left&lt; e_i, h \right&gt;_H = 0,
\]</span> then <span class="math inline">\(h = 0\)</span> almost everywhere.</p>
</blockquote>
<p><em>Proof.</em> First, we assume that <span class="math inline">\(h\)</span> is a continuous function on <span class="math inline">\([-\pi, \pi]\)</span>. If <span class="math inline">\(h \not\equiv 0\)</span>, then <span class="math inline">\(|h(x)|\)</span> achieves maximum value at some point <span class="math inline">\(x^* \in [-\pi, \pi]\)</span>. Without lose of generality, we assume that <span class="math display">\[
    h(x^*) = M &gt; 0. 
\]</span></p>
<p>By continuity of <span class="math inline">\(h\)</span>, <span class="math inline">\(\exists \delta \in (0, \pi)\)</span>, such that <span class="math inline">\(h(x) &gt; M / 2\)</span> in the interval <span class="math display">\[
    I \doteq (x^* - \delta, x^* + \delta) \cap [-\pi, \pi].
\]</span></p>
<p>We will capture the maximum value of <span class="math inline">\(f\)</span>, by taking Hermitian product of <span class="math inline">\(f\)</span> with a signal function that</p>
<ol type="1">
<li>is a linear combination of functions in <span class="math inline">\(\mathfrak{F}\)</span>;</li>
<li>is <span class="math inline">\(\ge 1\)</span> in <span class="math inline">\(I\)</span>;</li>
<li>is <span class="math inline">\(&lt; 1\)</span> in <span class="math inline">\([-\pi, \pi] \setminus I\)</span>.</li>
</ol>
<p>The signal function is given by <span class="math display">\[
    s(x) = 1 + \cos \left( \frac{1}{2} \cdot (x - x^*) \right) - \cos \frac{\delta}{2}.
\]</span></p>
<p>Observe that <span class="math inline">\(s\)</span></p>
<ol type="1">
<li>achieves maximum value <span class="math inline">\(s(x^*) = 2 - \cos \frac{\delta}{2}\)</span>;</li>
<li>is <span class="math inline">\(\ge 1\)</span> for <span class="math inline">\(x \in I\)</span>;</li>
<li>has period <span class="math inline">\(4 \pi\)</span>.</li>
</ol>
<p>Hence, it increases on the interval <span class="math inline">\([x^* - 2\pi, x^*]\)</span> and decreases on <span class="math inline">\([x^*, x^* + 2\pi]\)</span>. So</p>
<ol start="4" type="1">
<li><span class="math inline">\(s(x) &lt; 1\)</span> for <span class="math inline">\(x \in [-\pi, \pi] \setminus I\)</span>.</li>
</ol>
<p>For <span class="math inline">\(n \ge 1\)</span>, <span class="math inline">\(s^n(x)\)</span> is also a linear combination of functions in <span class="math inline">\(\mathfrak{F}\)</span>. It always holds that <span class="math inline">\(\left&lt; s^n(x), f \right&gt;_H \in \mathbb{R}\)</span> and by assumption on <span class="math inline">\(f\)</span>, it holds that <span class="math display">\[
    \left&lt; s^n(x), f \right&gt;_H = 0.
\]</span></p>
<p>But this is impossible. By monotonicity of integration, <span class="math display">\[
\int_{ [-\pi, \pi] \setminus I } f(x) s^n(x) \ dx \ge \int_{ [-\pi, \pi] \setminus I } (-M) \cdot 1 \ dx = - 2 \cdot \pi \cdot M.
\]</span></p>
<p>Define <span class="math display">\[
    I&#39; \doteq (x^* - \delta / 2, x^* + \delta / 2) \cap [-\pi, \pi].
\]</span></p>
<p>Then <span class="math inline">\(|I&#39;| \ge \delta / 2\)</span> and <span class="math inline">\(m \doteq \min_{x \in I&#39;} s(x) &gt; 1\)</span>. <span class="math display">\[
    \int_{ I } f(x) s^n(x) \ dx \ge \int_{ I&#39; } \frac{M}{2} \cdot m^n \ dx \ge \frac{M \cdot m^n \cdot \delta }{ 4 }.
\]</span></p>
<p>This implies as <span class="math inline">\(n \rightarrow \infty\)</span>, <span class="math display">\[
    \left&lt; s^n(x), f \right&gt;_H \ge - 2 \cdot \pi \cdot M + \frac{M \cdot m^n \cdot \delta }{ 4 } \rightarrow \infty, 
\]</span></p>
<p>which is a contradiction.</p>
<p>Next, we consider the general case of <span class="math inline">\(h \in I^2([-\pi, \pi])\)</span>. Define <span class="math display">\[
    w(x) = \int_{-\pi}^x h(t) \ dt.
\]</span></p>
<p>The function is absolutely continuous on <span class="math inline">\([-\pi, \pi]\)</span>. Moreover, <span class="math inline">\(w(0) = 0\)</span> and by assumption, <span class="math inline">\(w(\pi) = \left&lt; e_0, h \right&gt;_H = 0\)</span>. For <span class="math inline">\(k \in \mathbb{N}\)</span>, integrating by part gives <span class="math display">\[
    \begin{aligned}
        \sqrt{2 \cdot \pi} \cdot \left&lt; e_{2k + 1}, w \right&gt;_H 
            &amp;= \int_{ [-\pi, \pi] } \exp(-ikx) w(x) \ dx \\
            &amp;= \frac{1}{ik} \exp(-ikx) w(x) \mid_{-\pi}^\pi - \frac{1}{ik}  \int_{ [-\pi, \pi] } \exp(-ikx) w&#39;(x) \ dx \\
            &amp;=  - \frac{1}{ik}  \int_{ [-\pi, \pi] } \exp(-ikx) h(x) \ dx \\
            &amp;=  - \frac{1}{ik}  \left&lt; e_{2k + 1}, h\right&gt;_H \\
            &amp;= 0.
    \end{aligned}
\]</span></p>
<p>Similarly, we can prove that <span class="math inline">\(\left&lt; e_{2k + 2}, w \right&gt;_H = 0\)</span>.</p>
<p>Hence, <span class="math inline">\(\forall k \ge 1\)</span>, <span class="math inline">\(\left&lt; e_k, w \right&gt;_H = 0\)</span>. But it is not guaranteed that <span class="math inline">\(\left&lt; e_0, w \right&gt;_H = 0\)</span>. To fix this, we construct another function <span class="math display">\[
    W(x) \doteq w(x) - B.
\]</span></p>
<p>where <span class="math inline">\(B = \left&lt; e_0, w \right&gt;_H\)</span> is a constant. It holds that</p>
<ol type="1">
<li><span class="math inline">\(\forall k \ge 1\)</span>, <span class="math inline">\(\left&lt; e_k, W \right&gt;_H = \left&lt; e_k, w \right&gt;_H - \left&lt; e_k, B \right&gt;_H = - B \cdot \left&lt; e_k, e_0 \right&gt;_H = 0\)</span>.<br />
</li>
<li><span class="math inline">\(\left&lt; e_0, W \right&gt;_H = \left&lt; e_0, w \right&gt;_H + \left&lt; e_0, B \right&gt;_H = B - B \cdot \left&lt; e_0, e_0 \right&gt;_H = 0\)</span>.</li>
</ol>
<p>By previous result, <span class="math inline">\(W(x) \equiv 0\)</span> and <span class="math inline">\(w(x) \equiv B\)</span>. This implies <span class="math display">\[
w&#39;(x) = h(x) = 0, \quad a.e.
\]</span></p>
<p><span class="math inline">\(\square\)</span></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/51/">51</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">WOW</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">153</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WOW</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
