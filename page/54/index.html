<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="WOW">
<meta property="og:url" content="http://example.com/page/54/index.html">
<meta property="og:site_name" content="WOW">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="WOW">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/54/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>WOW</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">WOW</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">你生之前悠悠千載已逝<br>未來還會有千年沉寂的期待</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/11/20/Fermat-s-Little-Theorem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/20/Fermat-s-Little-Theorem/" class="post-title-link" itemprop="url">Fermat's Little Theorem</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-20 22:55:39" itemprop="dateCreated datePublished" datetime="2018-11-20T22:55:39+01:00">2018-11-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-07-15 05:48:50" itemprop="dateModified" datetime="2023-07-15T05:48:50+02:00">2023-07-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Fermat’s-Little-Theorem"><a href="#Fermat’s-Little-Theorem" class="headerlink" title="Fermat’s Little Theorem"></a>Fermat’s Little Theorem</h1><p>It is a fundamental result in number theory. </p>
<blockquote>
<p><strong>Theorem.</strong> Given a prime $p$, for every positive integer $a \in \mathbb{N}^+$, if $a \neq 0 \pmod p$, then </p>
<script type="math/tex; mode=display">
    a^{p - 1} = 1 \quad \pmod p.</script></blockquote>
<p>It suffices to prove the theorem for  numbers in $\mathbb{F}_p^+ \doteq { 1, 2, …, p - 1}$.</p>
<h1 id="Proof-One"><a href="#Proof-One" class="headerlink" title="Proof One"></a>Proof One</h1><p>Define the function $f : \mathbb{F}_p^+ \rightarrow \mathbb{F}_p^+$ to be </p>
<script type="math/tex; mode=display">
    f(x) = ax \pmod p.</script><p>For every $x \neq x’ \in \mathbb{F}_p^+$, $ax \neq ax’ \mod p$, otherwise $(x - x’) \mid p$. Hence $f$ is a bijection and </p>
<script type="math/tex; mode=display">
    \{f(1), f(2), ..., f(p - 1)\} = \mathbb{F}_p^+.</script><p>Now we take product over all number in  these two sets to obtain</p>
<script type="math/tex; mode=display">
(p - 1)! = \prod_{i = 1}^{p - 1} (ai) = a^{p - 1} (p - 1)! \pmod p</script><p>As $p$ is a prime, every non-zero integer has a multiplicative inverse mod $p$. Therefore we can cancel out $(p - 1)!$ from both side and get </p>
<script type="math/tex; mode=display">
    1 = a^{p - 1} \pmod p.</script><p>$\square$</p>
<p><strong>Remark:</strong> Fermat-Euler theorem relaxes the condition of $p$ being prime. It states that $\forall p, a \in \mathbb{N}^+$ with $\gcd(a, p) = 1$ (i.e., $a$ and $p$ are coprime), we have </p>
<script type="math/tex; mode=display">
a^{\varphi(p)} = 1 \pmod p,</script><p>where $\varphi(p)$ is the number of elements that are coprime to $p$ in ${1, 2, .., p - 1}$. When $p$ is prime, $\varphi(p)  = p - 1$. </p>
<p>The proof for the theorem is similar to the previous one. Let </p>
<script type="math/tex; mode=display">
    S \subseteq \{1, 2, .., p - 1\}</script><p>be the set of numbers coprime to  $p$ and define $f: S \rightarrow S$ to be </p>
<script type="math/tex; mode=display">
    f(x) = ax \pmod p</script><p>which is a bijection. Therefore, </p>
<script type="math/tex; mode=display">
    \prod_{x \in S} x = a^{\varphi(p)} \prod_{x \in S} x \pmod p</script><p>Cancelling out the factor $\prod_{x \in S} x$ from both side gives the desired result. </p>
<h1 id="Proof-Two"><a href="#Proof-Two" class="headerlink" title="Proof Two"></a>Proof Two</h1><p>This proof uses the binomial expansion as follows: </p>
<script type="math/tex; mode=display">
\begin{aligned}
    (a + 1)^p 
    &= a^p + \binom{p}{1} a^{p - 1} + ... + \binom{p}{p - 1} a + 1  &\pmod p \\
    &= a^{p} + 1 &\pmod p \\
    &= (a - 1)^{p} + 1 + 1 &\pmod p \\
    &= ... \\
    &= \begin{matrix} \underbrace{1 + 1 + ... + 1} \\ a + 1 \end{matrix} &\pmod p  \\
    &= a + 1 &\pmod p
\end{aligned}</script><p>The second equality holds since for $1 \le i \le p - 1$, the coefficient $\binom{p}{i} = \frac{p (p - 1) … (p - i + 1)}{i !}$ divides $p$, as $p$ is relative prime to all integers $1, 2, …, i$. The third equality follows from respectively applying the previous expansion. Finally, we get Fermat’s Little Theorem by multiplying both sides of $(a + 1)^p = (a + 1) \pmod p$ by the inverse of $a + 1$ module $p$. </p>
<h1 id="Proof-Three"><a href="#Proof-Three" class="headerlink" title="Proof Three"></a>Proof Three</h1><p>Let $a \in \mathbb{F}_p^+$. Consider the following numbers in $\mathbb{F}_p^+$: </p>
<script type="math/tex; mode=display">
    a, a^2, a^3, a^4, a^5, ...</script><p>As there are only $p - 1$ distinct numbers in $\mathbb{F}<em>p^+$, it holds that there exits a smallest $h \in \mathbb{N}</em>+$, such that </p>
<script type="math/tex; mode=display">
    a^h = 1 \pmod p.</script><p>Now consider the following procedure: </p>
<blockquote>
<ol>
<li>$\mathcal{U} \leftarrow \mathbb{F}_p^+;$     </li>
<li>$\mathcal{C} \leftarrow { }, i \leftarrow 0$;    </li>
<li>while $\mathcal{U} \neq \emptyset$ do:    </li>
<li>$\qquad$ $i \leftarrow i + 1$;    </li>
<li>$\qquad$ let $b$ be an element in $\mathcal{U}$;        </li>
<li>$\qquad$ let $S_i \leftarrow { b, ab, a^2b, …, a^{h - 1} b}$;          </li>
<li>$\qquad$ $\mathcal{U} \leftarrow \mathcal{U} \setminus S_i$;     </li>
<li>$\qquad$ $\mathcal{C} \leftarrow \mathcal{C} \cup { S_i }$;   </li>
</ol>
</blockquote>
<p>Suppose that $\mathcal{C} = { S_1, …, S_m }$. We claim that </p>
<ul>
<li><p>The elements in $S_i$ are distinct. Otherwise, </p>
<script type="math/tex; mode=display">
      a^k b = a^\ell b \pmod p \Longrightarrow a^{k - \ell} b= 0 \pmod p,</script><p>  a contradiction. If follows that $|S_i| = h$.   </p>
</li>
<li><p>For $i \neq j$, $S_i \cap S_j = \emptyset$. Otherwise, let $b \in S_i \cap S_j$. Then every element in $S_i \cup S_j$ can be expressed as $a^k b$ for some integer $k$.   </p>
</li>
</ul>
<p>It follows that $\mathcal{C}$ is a partition of $\mathbb{F}_p^+$. As each set in $\mathcal{C}$ has the same size, we have $h \mid (p - 1)$ and </p>
<script type="math/tex; mode=display">
    a^{p - 1} = 1 \pmod p.</script><p>$\square$</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/11/08/Euclidean-Algorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/08/Euclidean-Algorithm/" class="post-title-link" itemprop="url">Euclidean Algorithm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-08 10:08:51" itemprop="dateCreated datePublished" datetime="2018-11-08T10:08:51+01:00">2018-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-18 05:54:31" itemprop="dateModified" datetime="2021-03-18T05:54:31+01:00">2021-03-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>We discuss the Euclidean algorithm and use it to compute the
multiplicative inverse.</p>
<blockquote>
<p><strong>Multiplicative Inverse.</strong> Given <span
class="math inline">\(x, y \in \mathbb{N}^+\)</span>, <span
class="math inline">\(z\)</span> is called the multiplicative inverse of
<span class="math inline">\(x\)</span> (module <span
class="math inline">\(y\)</span>) if <span class="math display">\[
xz \equiv 1 \pmod y.
\]</span></p>
</blockquote>
<h1 id="theorem-1">Theorem 1</h1>
<blockquote>
<p><span class="math inline">\(x\)</span> has a multiplicative inverse
module <span class="math inline">\(y \iff \gcd(x, y) = 1\)</span>.</p>
</blockquote>
<p><strong>Proof.</strong><br />
Define the set <span class="math inline">\(S = \{ ax + by \mid a, b \in
Z\}\)</span>. Let <span class="math inline">\(d = a^* x + b^* y\)</span>
be the smallest positive integer in <span
class="math inline">\(S\)</span>. Our proof relies on the following
lemma.</p>
<blockquote>
<p><strong>Lemma</strong>: <span class="math inline">\(\gcd(x,y) =
d\)</span>.</p>
<p>First, as <span class="math inline">\(d\)</span> is a linear
combination of <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span>, <span class="math inline">\(\gcd(x, y)
| d\)</span> and <span class="math inline">\(\gcd(x, y) \le
d\)</span>.</p>
</blockquote>
<p>Second, we claim that <span class="math inline">\(d | x\)</span> and
<span class="math inline">\(d | y\)</span>. By symmetry, we prove only
the former. If not, suppose that <span class="math inline">\(d \nmid
x\)</span>. Then <span class="math inline">\(\exists k \in \mathbb{Z},
\ell \in [1, d - 1]\)</span>, s.t.,<br />
<span class="math display">\[
    x = k d + \ell.
\]</span></p>
<p>Since <span class="math inline">\(\ell = x - k d\)</span> is a linear
combination of <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span>, it holds that <span
class="math inline">\(\ell \in S\)</span>, contradicting <span
class="math inline">\(d\)</span> being the smallest positive element in
<span class="math inline">\(S\)</span>.</p>
<p>It concludes that <span class="math inline">\(d\)</span> equals to
<span class="math inline">\(\gcd(x, y)\)</span>.</p>
<p><span class="math inline">\(\square\)</span></p>
<p>The proof of the above theorem immediately follows from the
lemma.</p>
<ol type="1">
<li><p><span class="math inline">\(\gcd(x, y) = 1 \rightarrow x\)</span>
has a multiplicative inverse.<br />
In this case, <span class="math inline">\(d = a^* x + b^* y =
1\)</span>. <span class="math inline">\(a^*\)</span> is th
multiplicative inverse of <span class="math inline">\(x\)</span> module
<span class="math inline">\(y\)</span>.</p></li>
<li><p><span class="math inline">\(x\)</span> has a multiplicative
inverse <span class="math inline">\(\rightarrow \gcd(x, y) =
1\)</span>.<br />
If <span class="math inline">\(x\)</span> has a multiplicative inverse,
there exists some <span class="math inline">\(z\)</span> and <span
class="math inline">\(l\)</span>, such that <span
class="math inline">\(zx = ly + 1\)</span>.</p></li>
</ol>
<p><span class="math inline">\(\blacksquare\)</span></p>
<h1 id="theorem-2">Theorem 2</h1>
<blockquote>
<p>If <span class="math inline">\(x\)</span> has a multiplicative
inverse module <span class="math inline">\(y\)</span>, it is unique.</p>
</blockquote>
<p><strong>Proof.</strong><br />
Let <span class="math inline">\(a\)</span> and <span
class="math inline">\(b\)</span> both be the multiplicative inverse of
<span class="math inline">\(x\)</span> module <span
class="math inline">\(y\)</span>, then <span class="math display">\[
    a \equiv a (xb) \equiv (ax) b \equiv b \pmod y
\]</span></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<h1 id="basic-euclidean-algorithm">Basic Euclidean Algorithm</h1>
<p>Euclidean algorithm computes <span class="math inline">\(\gcd(x,
y)\)</span> as follows:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> <span class="title">gcd</span><span class="params">(<span class="type">unsigned</span> x, <span class="type">unsigned</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(y == <span class="number">0</span>) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">gcd</span>(y, x % y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="correctness">Correctness</h2>
<p>If <span class="math inline">\(y =0\)</span>, whether <span
class="math inline">\(x = 0\)</span> or not, we have <span
class="math inline">\(\gcd(x, y) = x\)</span>.</p>
<p>If <span class="math inline">\(x &lt; y\)</span>, <span
class="math inline">\(x \mod y = x\)</span>. The algorithm exchanges
<span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> at the first recursion. It suffices to
consider only <span class="math inline">\(x \ge y &gt; 0\)</span>.</p>
<p>If <span class="math inline">\(x \ge y &gt; 0\)</span>, then <span
class="math inline">\(\gcd(x, y) = \gcd(y, x \mod y)\)</span>. Let <span
class="math inline">\(d = \gcd(x, y)\)</span>. Clearly <span
class="math inline">\(d | x\)</span> and <span class="math inline">\(d |
y\)</span>. We claim that <span class="math display">\[
    d | (x \mod y)
\]</span><br />
Suppose <span class="math inline">\(x = k d\)</span> and <span
class="math inline">\(y = \ell d\)</span>, then <span
class="math inline">\(x \mod y = d \cdot (k \mod \ell)\)</span>, which
finishes proof.</p>
<h2 id="time">Time</h2>
<blockquote>
<p>Let <span class="math inline">\(n\)</span> be the the total number of
bits to represent <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span>. Then the algorithm stops after <span
class="math inline">\(O(n)\)</span> recursions.</p>
</blockquote>
<p><strong>Proof.</strong></p>
<p>We can assume <span class="math inline">\(x \ge y\)</span>.
Otherwise, they are swapped by a recursive call.</p>
<p>The key observation is that, after every two recursive calls, the
first argument <span class="math inline">\(x\)</span> shrinks at least
by a factor of two.</p>
<ol type="1">
<li>If <span class="math inline">\(y \le x / 2\)</span>, the observation
holds after the first call.<br />
</li>
<li>If <span class="math inline">\(y &gt; x / 2\)</span>, then after two
recursive call, the first argument becomes <span class="math inline">\(x
\mod y\)</span>, which is smaller than <span class="math inline">\(x /
2\)</span>.</li>
</ol>
<p><span class="math inline">\(\square\)</span></p>
<h1 id="extended-euclidean-algorithm">Extended Euclidean Algorithm</h1>
<p>We extend the basic version to return a pair <span
class="math inline">\(a^*, b^* \in \mathbb{N}\)</span> s.t. <span
class="math inline">\(\gcd(x, y) = d = a^* x + b^* y\)</span>.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::pair&lt;<span class="type">unsigned</span>, <span class="type">unsigned</span>&gt; <span class="title">gcd</span><span class="params">(<span class="type">unsigned</span> x, <span class="type">unsigned</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(y == <span class="number">0</span>) <span class="keyword">return</span> &#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">auto</span> (a<span class="number">&#x27;</span>, b<span class="number">&#x27;</span>) = <span class="built_in">gcd</span>(y, x mod y);</span><br><span class="line">    <span class="keyword">return</span> (b<span class="number">&#x27;</span>, a<span class="number">&#x27;</span> - b<span class="number">&#x27;</span> * (x / y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="correctness-1">Correctness</h2>
<p>Suppose <span class="math inline">\(s = a&#39; y + b&#39; \cdot (x
\mod y)\)</span>. Then <span class="math display">\[
    s = a&#39; y + b&#39;(x - \lfloor x / y \rfloor \cdot y) =b&#39; x +
(a&#39; - b&#39; \cdot \lfloor x / y \rfloor) \cdot y
\]</span> This is why the algorithm work.</p>
<p><span class="math inline">\(\square\)</span></p>
<h2 id="example">Example</h2>
<p><span class="math display">\[
\begin{aligned}
&amp; \gcd(9, 6) = (3, 1, -1)  \quad [-1 = 0 - 1 * 9 / 6] \\
&amp; \rightarrow \gcd(6, 3) = (3, 0, 1) \quad [1 = 1 - 0 * 6 / 3]\\
&amp; \quad \rightarrow \gcd(3, 0) = (3, 1, 0) \\
\end{aligned}
\]</span></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/10/26/Bellman-Ford/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/26/Bellman-Ford/" class="post-title-link" itemprop="url">Bellman Ford</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2018-10-26 13:13:41 / Modified: 17:06:16" itemprop="dateCreated datePublished" datetime="2018-10-26T13:13:41+02:00">2018-10-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Here we discuss the Bellman Ford algorithm for computing shortest
path or negative cycle in an undirected weighted graph <span
class="math inline">\(G = (V, E, W)\)</span> that contains negative
edges.</p>
<p>Recall the Dijkstra algorithm bases on the induction of the number of
vertices. The Bellman Ford algorithm, on the other hand, bases on the
induction of the number of edges of the shortest path.</p>
<p>Let <span class="math inline">\(P_k = (s, v_1, v_2, .., v_k,
t)\)</span> be the shortest path between <span
class="math inline">\(s\)</span> and <span
class="math inline">\(t\)</span>. If we finds the shortest <span
class="math inline">\(P_{k - 1} = (s, v_1, v_2, ..., v_{k -
1})\)</span>, then we can easily find the path <span
class="math inline">\(P_k\)</span>. To this end, we define dist[v] the
distance from source node <span class="math inline">\(s\)</span> to
vertex <span class="math inline">\(v\)</span>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;int&gt; dist(n, INT_MAX); </span><br><span class="line">std::vector&lt;int&gt; pred(n, 0);</span><br><span class="line">dist[s] = 0;</span><br><span class="line">for(int i = 0; i &lt; n - 1; ++i) &#123;</span><br><span class="line">    for each edge (u, v) &#123;</span><br><span class="line">        if(dist[u] + w(u, v) &lt; dist[v]) &#123;</span><br><span class="line">            dist[v] = dist[u] + w(u, v);</span><br><span class="line">            pred[v] = u;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If the graph does not contain a negative cycle, the above code
compute the shortest path correctly. On the other hand, to check the
existence of a negative, we could execute an additional iteration after
the above code</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bool check_negative_cycle() &#123;</span><br><span class="line">     for each edge (u, v) &#123;</span><br><span class="line">        if(dist[u] + w(u, v) &lt; dist[v]) &#123;</span><br><span class="line">            dist[v] = dist[u] + w(u, v);</span><br><span class="line">            pred[v] = u;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;    </span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The correctness can be verified as follows: if the graph does not
contain negative cycle, the any shortest path contains at most <span
class="math inline">\((n - 1)\)</span>-th edges. The value of <span
class="math inline">\(dist[v]\)</span> should not change in this <span
class="math inline">\(n\)</span>-th iteration.</p>
<p>To return a negative cycle, when we find an edge <span
class="math inline">\((u, v)\)</span> such that <span
class="math inline">\(dist[u] + w(u, v) &lt; dist[v]\)</span> (in this
<span class="math inline">\(n\)</span>-th iteration), we can trace the
predecessor of <span class="math inline">\(v\)</span> until we encounter
a cycle. Notice that this cycle may not necessarily contains <span
class="math inline">\(v\)</span>. But we claim that this cycle must be
negative.</p>
<h4 id="theorem">Theorem</h4>
<p>Let <span class="math inline">\(C = (v_1, v_2, ..., v_j)\)</span> be
the cycle we found, such that <span class="math inline">\(pred[v_i] =
pred[v_{i - 1}], \forall 2 \le i \le j\)</span> and <span
class="math inline">\(pred[v_1] = v_j\)</span>. WLOG, let <span
class="math inline">\(v_1\)</span> be the vertex whose value <span
class="math inline">\(pred[v_1]\)</span> is updated latest among <span
class="math inline">\(pred[v_1], pred[v_2], ..., pred[v_j]\)</span>. It
holds that</p>
<p><span class="math display">\[
\begin{aligned}
dist[v_2] &gt; dist[v_1] + w(v_1, v_2) \\
\text{this holds with strict inequality since we update } pred[v_1]
\text{ lastly }\\
dist[v_3] \ge dist[v_2] + w(v_1, v_2) \\
... \\
dist[v_1] = dist[v_j] + w(v_1, v_2) \\
\end{aligned}
\]</span></p>
<p>It follows that <span class="math inline">\(\sum_{i = 1}^j dist[v_i]
&gt; \sum_{i = 1}^j dist[v_i] dist[v_i] + \sum_{i = 2}^j w(v_{i - 1},
v_i) + w(v_j, v_1)\)</span>, which implies that <span
class="math inline">\(\sum_{i = 2}^j w(v_{i - 1}, v_i) + w(v_j, v_1)
&lt; 0\)</span>.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/53/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/53/">53</a><span class="page-number current">54</span><a class="page-number" href="/page/55/">55</a><span class="space">&hellip;</span><a class="page-number" href="/page/66/">66</a><a class="extend next" rel="next" href="/page/55/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">WOW</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">196</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WOW</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
