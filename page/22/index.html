<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="WOW">
<meta property="og:url" content="http://example.com/page/22/index.html">
<meta property="og:site_name" content="WOW">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="WOW">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/22/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>WOW</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">WOW</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">你生之前悠悠千載已逝<br>未來還會有千年沉寂的期待</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/10/08/Balanced-Binary-Search-Tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/08/Balanced-Binary-Search-Tree/" class="post-title-link" itemprop="url">Balanced Binary Search Tree</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-10-08 11:49:33" itemprop="dateCreated datePublished" datetime="2019-10-08T11:49:33+11:00">2019-10-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-10-11 12:17:57" itemprop="dateModified" datetime="2019-10-11T12:17:57+11:00">2019-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>It is the depth of the binary search that affects the performance of it. We say that a binary search tree with <span class="math inline">\(n\)</span> nodes is balanced if its depth is of order <span class="math inline">\(O(\log n)\)</span> (hence we can perform find, insert and delete operations in time <span class="math inline">\(O(\log n)\)</span>).</p>
<p>If a tree is unbalanced, we can maintain the balance by rotation. Further, we need some criteria to guide the rotation. In what's follows we discuss some of the popular design of the criteria.</p>
<h4 id="by-the-number-of-elements-of-the-subtree.">By the number of elements of the subtree.</h4>
<p>Denote a note <span class="math inline">\(v\)</span> and its left and right child <span class="math inline">\(v.left\)</span> and <span class="math inline">\(v.right\)</span> respectively. Define the size of <span class="math inline">\(v\)</span> (<span class="math inline">\(s(v)\)</span>) the number of elements contained in the subtree rooted at <span class="math inline">\(v\)</span>.</p>
<p>A critical observation is that, if for each node <span class="math inline">\(v\)</span> of the tree, the size of each of it subtrees is at most a constant fraction <span class="math inline">\(\big(\)</span> denoted as <span class="math inline">\(\epsilon \in (\frac{1}{2}, 1)\)</span>; Exercise: why can't we pick <span class="math inline">\(\epsilon \in [0, \frac{1}{2}] \big)\)</span> of its size, i.e., <span class="math display">\[
s(v.left) \le \epsilon s(v) \\
s(v.right) \le \epsilon s(v) 
\]</span> then the depth of the tree is in the order of <span class="math inline">\(O(\log n)\)</span>. The reason is obvious: let <span class="math inline">\(r = v_0, v_1, v_2, ..., v_k\)</span> be any root-to-leaf path of the tree, then <span class="math display">\[
s(v_1) \le \epsilon s(v_0) \\
s(v_2) \le \epsilon s(v_1) \\
...\\
s(v_k) \le \epsilon s(v_{k - 1})
\]</span> it follows that <span class="math inline">\(1 = s(v_k) \le \epsilon^k s(v_0) = \epsilon^k n\)</span> and <span class="math inline">\(k \le \log_\epsilon \frac{1}{n} = O(\log n)\)</span>.</p>
<p>Therefore, we can pick arbitrary <span class="math inline">\(\epsilon \in (\frac{1}{2}, 1)\)</span> and maintain this criteria explicitly and recursively.</p>
<p>WLOG, suppose a new element is inserted into the left subtree of a vertex <span class="math inline">\(v\)</span>. Denote the new size function <span class="math inline">\(s\)</span> as <span class="math inline">\(s&#39;\)</span> after insertion. If after insertion, <span class="math inline">\(s&#39;(v.left) \le \epsilon s&#39;(v)\)</span>, we do nothing and check the balance of <span class="math inline">\(v\)</span>'s parent (if there is any). Otherwise, we may try a right rotation on <span class="math inline">\(v\)</span>: <span class="math display">\[
\begin{aligned}
&amp;\qquad \qquad v \\
&amp;/           &amp;\setminus \\
&amp;v.left      &amp;&amp;v.right \\
/           &amp;\setminus \\
v.left.left &amp; \quad v.left.right
\end{aligned}
\]</span> the subtree transform into: <span class="math display">\[
\begin{aligned}
&amp;\qquad \qquad v.left \\
&amp;/         &amp;\setminus \\
v.left.left     &amp;&amp; v\\
           &amp;&amp;/  &amp;\setminus \\
 &amp;&amp; v.left.right &amp; \quad v.right
\end{aligned}
\]</span> Since before insertion, <span class="math inline">\(s(v.left) \le \epsilon s(v)\)</span>, it holds that <span class="math inline">\(s&#39;(v.left.left) \le \epsilon s&#39;(v.left) = \epsilon (s(v) + 1)\)</span>. Therefore, the left subtree no longer violate the balance constraint. However, the constraint could be violated by the right subtree. Since it is possible that <span class="math display">\[
s&#39;(v.left.right) + s&#39;(v.right) + 1 &gt; \epsilon s&#39;(v.left) = \epsilon (s(v)  + 1)
\]</span> For example, suppose that <span class="math inline">\(\epsilon = 0.8\)</span> and <span class="math inline">\(s(v.left.right) = 0.8 s(v.left) = 0.64 s(v)\)</span> and <span class="math inline">\(s(v.right) = 0.2 s(v) - 1\)</span>, then <span class="math display">\[
s(v.left.right) + s(v.right) + 1 = 0.84 s(v)
\]</span> The reason is that there is so much weight that <span class="math inline">\(v.left.right\)</span> has. Therefore, we don't want to rotate it to the right subtree. An alternative is to perform a left rotate on the left subtree first <span class="math display">\[
\begin{aligned}
&amp;\qquad \qquad v \\
&amp;/           &amp;\setminus \\
&amp;v.left.right      &amp;&amp;v.right \\
/           &amp;\setminus \\
v.left &amp; \quad v.left.right.right \\
/ \setminus &amp; \\
v.left.left &amp; \quad v.left.right.left
\end{aligned}
\]</span> Followed by a right rotation on <span class="math inline">\(v\)</span>: <span class="math display">\[
\begin{aligned}
&amp;\qquad \qquad v.left.right  \\
&amp;/           &amp;\setminus \\
&amp;v.left     &amp;&amp;v \\
/ &amp;\setminus   &amp;&amp;/ \setminus\\
v.left.left &amp;\quad v.left.right.left&amp; \quad v.left.right.right &amp;\quad v.right\\ 
\end{aligned}
\]</span></p>
<p>To satisfy the balance requirement, we require that</p>
<ol type="1">
<li><span class="math inline">\(s&#39;&#39;(v.left.right.left) = s&#39;(v.left.right.left) \le \epsilon s&#39;&#39;(v.left) = \epsilon (s&#39;(v.left) - s&#39;(v.left.right.right) -1 )\)</span>.</li>
<li><span class="math inline">\(s&#39;(v.left.left) \le s&#39;(v.left)\)</span></li>
<li><span class="math inline">\(s&#39;(v.left.right.right) + s&#39;(v.right) + 1 \le \epsilon s&#39;(v.left.right)\)</span></li>
</ol>
<p>Condition 1 implies that <span class="math inline">\(s&#39;(v.left.right.right)\)</span> can take up too much weight of <span class="math inline">\(s&#39;(v.left)\)</span>, which imposes an upper bound on <span class="math inline">\(\epsilon\)</span> by <span class="math display">\[
 (1 - \epsilon) \epsilon s&#39;(v.left) - 1 \le \epsilon (s&#39;(v.left) - \epsilon^2s&#39;(v.left) - 1)
\]</span></p>
<h4 id="by-the-height-of-the-subtree-avl-tree">By the height of the subtree (AVL Tree)</h4>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/09/18/Divided-by-Three/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/18/Divided-by-Three/" class="post-title-link" itemprop="url">Divided by Three</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-09-18 21:51:17" itemprop="dateCreated datePublished" datetime="2019-09-18T21:51:17+10:00">2019-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-09-22 11:44:19" itemprop="dateModified" datetime="2019-09-22T11:44:19+10:00">2019-09-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Given a number <span class="math inline">\(x = (x_1x_2x_3...x_n)_{10}\)</span> in decimal form, what is reminder divided by 3.</p>
<p>Note that for any positive integer <span class="math inline">\(k\)</span>, <span class="math display">\[
10^k \equiv 1^k \equiv 1 \mod 3
\]</span></p>
<p>Therefore, <span class="math display">\[
x = x_1 10^{n - 1} + x_2 10^{n - 2} + ... + x^n \equiv x_1 + x_2 + ... + x_n \mod 3
\]</span></p>
<p><span class="math inline">\(\square\)</span>.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/09/03/Primality-Test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WOW">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/03/Primality-Test/" class="post-title-link" itemprop="url">Primality Test</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-09-03 17:15:48" itemprop="dateCreated datePublished" datetime="2019-09-03T17:15:48+10:00">2019-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-12-02 19:56:55" itemprop="dateModified" datetime="2019-12-02T19:56:55+11:00">2019-12-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Although there is no polynomial algorithm for computing the prime decomposition of an integer, testing primality can be done in polynomial time. The central idea of is to find a certificate that we can verify in polynomial time for the compositeness of an integer.</p>
<p>We begin with Fermat's Test, which gives false positive but works for most cases. It relies on the Fermat's Little Theorem and Lagrange Theorem.</p>
<h3 id="fermats-little-theorem.">Fermat's Little theorem.</h3>
<p>If <span class="math inline">\(n\)</span> is a prime number, then for any <span class="math inline">\(x \in [n - 1]\)</span>, we have <span class="math display">\[
x^{n - 1} \equiv 1 \mod n
\]</span></p>
<p>where throughout the article we use <span class="math inline">\([n - 1]\)</span> to denote the integer set <span class="math inline">\(\{1, 2, ..., n - 1\}\)</span>.</p>
<p><strong>Proof:</strong> Consider the set of numbers <span class="math inline">\(\langle x, 2x, 3x, ..., (n - 1)x \rangle\)</span>. Note that all numbers are different in terms of <span class="math inline">\(\mod n\)</span>. Otherwise <span class="math inline">\(ix \equiv jx \mod n\)</span> implies that <span class="math inline">\((i - j) x \equiv 0 \mod n\)</span>. But <span class="math inline">\(i \neq j\)</span> and <span class="math inline">\(x \neq 0\)</span> concludes that <span class="math inline">\(n\)</span> in not prime, a contradiction. <span class="math inline">\(\blacksquare\)</span></p>
<h4 id="lagrange-theorem">Lagrange Theorem</h4>
<p>If <span class="math inline">\(Z\)</span> is a finite group and <span class="math inline">\(S\)</span> is a subgroup of <span class="math inline">\(Z\)</span>, then the size of <span class="math inline">\(S\)</span> divides that of <span class="math inline">\(Z\)</span>, i.e., <span class="math inline">\(|S| \equiv 0 \mod |Z|\)</span>.</p>
<p><strong>Proof</strong>: Order the elements in <span class="math inline">\(Z\)</span> as <span class="math inline">\(z_1, z_2, ... z_n\)</span>. Consider the sets defined by <span class="math display">\[
z_i S \doteq \{ z \in S, s.t., z = z_i \cdot s, where \quad  s \in S\}
\]</span> We claim <span class="math inline">\(|z_i S| = |S|\)</span>. This is true as for <span class="math inline">\(x \in S, y \in S\)</span> and <span class="math inline">\(x \neq y\)</span>, we have <span class="math inline">\(z_i x \neq z_i y\)</span>.</p>
<p>Now we have the collection of sets <span class="math inline">\(z_1 S, z_2 S, ..., z_n S\)</span>. We remove duplicates among them and keep only one copy of each set. Suppose <span class="math inline">\(m\)</span> sets are left and reorder them as <span class="math inline">\(S_1, S_2, ..., S_m\)</span>, then they constitute a partition of <span class="math inline">\(Z\)</span>.</p>
<ol type="1">
<li>Clearly <span class="math inline">\(S_1 \cup S_2 \cup ... \cup S_m = Z\)</span>.</li>
<li>Moreover, <span class="math inline">\(S_i \cap S_j = \emptyset\)</span>. for <span class="math inline">\(i \neq j\)</span>. Otherwise, let <span class="math inline">\(x \in S_i \cap S_j\)</span>. By definition of <span class="math inline">\(S_i\)</span> and <span class="math inline">\(S_j\)</span>, there exists <span class="math inline">\(z&#39; \in Z\)</span> and <span class="math inline">\(z&#39;&#39; \in Z\)</span>, such that <span class="math inline">\(S_i = z&#39; S\)</span> and <span class="math inline">\(S_j = z&#39;&#39; S\)</span>. Then <span class="math inline">\(x = z&#39; x = z&#39;&#39; y\)</span> for some <span class="math inline">\(x, y \in S\)</span>. It follows that <span class="math inline">\(z&#39; = z&#39;&#39; y x^{-1} \in z&#39;&#39; S\)</span> and <span class="math inline">\(S_i = S_j\)</span>, contradiction the construction of <span class="math inline">\(S_i\)</span> and <span class="math inline">\(S_j\)</span>.</li>
</ol>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>Before proceeding to the algorithm, we introduce a lemma.</p>
<h4 id="lemma">Lemma</h4>
<p>Given two positive integers <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, if <span class="math inline">\(gcd(n, m) = k\)</span>, then <span class="math inline">\(\exists a, b \in Z\)</span>, s.t., <span class="math inline">\(an + bm = k\)</span>.</p>
<p><strong>Proof.</strong>. Consider the set <span class="math inline">\(E = \{ an + bm, a, b\in Z\}\)</span> and define <span class="math inline">\(c = \min_{e \in E \wedge e &gt; 0} e\)</span>. Note that <span class="math inline">\(c\)</span> is well-defined -- since both <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> are positive, there are positive integers in <span class="math inline">\(E\)</span>. Further, it holds that <span class="math inline">\(c \le n (a = 1, b = 0)\)</span> and <span class="math inline">\(c \le m (a = 0, b = 1)\)</span>.</p>
<p>We claim that <span class="math inline">\(c \equiv 0 \mod n\)</span> and <span class="math inline">\(c \equiv 0 \mod m\)</span>. WLOG, we prove only the former case. Suppose it is not, let <span class="math inline">\(y \equiv c \mod n\)</span>. There exists integers <span class="math inline">\(x\)</span> s.t., <span class="math inline">\(cx + y = n\)</span> . But now it follows that <span class="math inline">\(y = n - xc \in E\)</span>, contradicting the definition of <span class="math inline">\(c\)</span>.</p>
<p>Now <span class="math inline">\(c\)</span> is common divisor of <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>. It is also the greatest one, since every divisor of <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> divides any element in <span class="math inline">\(E\)</span>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<h3 id="algorithm-fermats-test.">Algorithm : Fermat's Test.</h3>
<p>The algorithm is relatively easy and shown as follows.</p>
<ol type="1">
<li>Input: an integer <span class="math inline">\(n\)</span>.</li>
<li>Output: whether <span class="math inline">\(n\)</span> is a prime number.</li>
<li>Take a number of <span class="math inline">\(x \in [n - 1]\)</span> uniformly at random.</li>
<li>Check whether <span class="math inline">\(x^{n - 1} \equiv 1 \mod n\)</span>. If not, output "NO".</li>
<li>Repeat steps <span class="math inline">\(3, 4\)</span> a specified number of times.</li>
<li>Output "YES".</li>
</ol>
<p>Now we analyze the algorithm. Given <span class="math inline">\(n\)</span>, denote <span class="math inline">\(Z_n^* = \{ x \in [n - 1] \wedge gcd(x, n) = 1 \}\)</span>, i.e., the set of numbers in <span class="math inline">\([n - 1]\)</span> that are coprime to <span class="math inline">\(n\)</span>. Note that <span class="math inline">\(Z_n^*\)</span> is a group under multiplication:</p>
<ul>
<li><span class="math inline">\(1 \in Z_n^*\)</span>.</li>
<li>If <span class="math inline">\(x \in Z_n^*\)</span>, then <span class="math inline">\(\exists a, b \in Z\)</span>, s.t., <span class="math inline">\(ax + bn = 1\)</span> by definition of <span class="math inline">\(Z_n^*\)</span>. Hence <span class="math inline">\((a \mod n ) \in Z_n^*\)</span> and <span class="math inline">\(x^{-1} = (a \mod n )\)</span>.</li>
<li>If <span class="math inline">\(x, y \in Z_n^*\)</span>, then <span class="math inline">\(gcd(xy, n) = 1\)</span>, therefore <span class="math inline">\(xy \in Z_n^*\)</span>.</li>
<li>Clearly multiplication is associative.</li>
</ul>
<p>On the other hand, consider the set of integers that satisfies Fermat's Little Theorem: <span class="math inline">\(S = \{ x \in [n - 1] \wedge x^{n - 1} \equiv 1 \mod n \}\)</span>. Clearly <span class="math inline">\(S\)</span> is a subset of <span class="math inline">\(Z_n^*\)</span>, since elements in <span class="math inline">\(S\)</span> are invertible module <span class="math inline">\(n\)</span>. Besides, <span class="math inline">\(S\)</span> is itself a group:</p>
<ul>
<li><span class="math inline">\(1 \in S\)</span>.</li>
<li>If <span class="math inline">\(x \in S\)</span>, then <span class="math inline">\(x^{(n - 2)(n - 1)} \equiv x^{(n - 1)(n - 2)} \equiv 1 \mod n\)</span>. It holds that <span class="math inline">\(x^{n - 2} \in S\)</span> and <span class="math inline">\(x^{-1} = x^{n - 2}\)</span>. (The other way to see this is that <span class="math inline">\(1 \equiv x x^{-1} \equiv x^{n - 1} x^{- (n - 1)} \equiv x^{- (n - 1)}\)</span>, hence <span class="math inline">\(x^{-1} \in S\)</span>.)</li>
<li>Clearly multiplication is associative.</li>
<li>If <span class="math inline">\(x, y \in S\)</span>, then <span class="math inline">\((xy)^{n - 1} \equiv x^{n - 1} y^{n - 1} \equiv 1 \mod n\)</span>.</li>
</ul>
<p>Therefore, <span class="math inline">\(S\)</span> is a subgroup of <span class="math inline">\(Z_n^*\)</span>. As <span class="math inline">\(Z_n^*\)</span> is finite, by <em>Lagrange's Theorem</em>,</p>
<p><span class="math display">\[
|Z_n^*| \text{ is a multiple of } |S|
\]</span></p>
<p>If there is an element <span class="math inline">\(x \in Z_n^*\)</span> but <span class="math inline">\(x \notin S\)</span>, then <span class="math inline">\(|Z_n^*| \ge 2 |S|\)</span> and step <span class="math inline">\(3, 4\)</span> successfully reports "NO" with probability at least a half.</p>
<p>However relative rare, systematic error exists. There are numbers such that all numbers coprime to them satisfy Fermat's Little Theorem, i.e., <span class="math inline">\(|Z_n^*| = |S|\)</span>. The smallest one, 561, was found by Carmichael in 1910 and such number are called Carmichael numbers. This motivates the invention of the Rabin/Miller test. The heart lies on finding a pseudo square root of <span class="math inline">\(1\)</span>.</p>
<h5 id="theorem">Theorem</h5>
<p>If <span class="math inline">\(n\)</span> is prime and <span class="math inline">\(x^2 \equiv 1 \mod n\)</span>, then <span class="math inline">\(x = \pm 1 \mod n\)</span>, where <span class="math inline">\(-1 \mod n\)</span> is defined as <span class="math inline">\(n - 1\)</span>.</p>
<p>Proof: <span class="math inline">\(x^2 \equiv 1 \mod n\)</span> implies <span class="math inline">\((x - 1)(x + 1) \equiv 0 \mod n\)</span>. As <span class="math inline">\(n\)</span> is a prime, <span class="math inline">\(x - 1 \equiv 0 \mod n\)</span> or <span class="math inline">\(x + 1 \equiv 0 \mod n\)</span>. <span class="math inline">\(\blacksquare\)</span></p>
<p>Observe that when <span class="math inline">\(n &gt; 2\)</span>, <span class="math inline">\(n - 1 \neq 1\)</span>.</p>
<h3 id="algorithm-2-rabin-miller-test">Algorithm 2: Rabin Miller Test</h3>
<ol type="1">
<li><p>Input: an integer <span class="math inline">\(n\)</span>.</p></li>
<li><p>Output: whether <span class="math inline">\(n\)</span> is a prime number.</p></li>
<li><p>If <span class="math inline">\(n \neq 2\)</span> and <span class="math inline">\(n\)</span> is even, output "NO".</p></li>
<li><p>If <span class="math inline">\(n\)</span> is the power of some integer, output "NO".</p></li>
<li><p>Find the maximum integer <span class="math inline">\(k\)</span>, such that <span class="math inline">\(n - 1 = 2^k m\)</span> for some odd number <span class="math inline">\(m\)</span>.</p></li>
<li><p>Take a number of <span class="math inline">\(x \in [n - 1]\)</span> uniformly at random.</p></li>
<li><p>Check whether <span class="math inline">\(x^{n - 1} \equiv 1 \mod n\)</span>. If not, output "NO". [Now Fermat's Test Is Passed. Need Further Verification.]</p></li>
<li><p>Otherwise, compute the certificate <span class="math display">\[
C = (x^m, x^{2m}, x^{4m}, ..., x^{2^{k - 1}m}, x^{2^km})
\]</span> We must have <span class="math inline">\(x^{2^km} \equiv 1\)</span> since it passes Fermat's test. We check whether <span class="math inline">\(\exists i\)</span>, such that <span class="math inline">\(x^{2^i m} \neq \pm 1\)</span> but <span class="math inline">\(x^{2^{i + 1} m} = 1\)</span>. If so, we find a pseudo square root of unity and output "NO".</p></li>
<li><p>Repeat steps <span class="math inline">\(6 - 8\)</span> a specified number of times.</p></li>
<li><p>Output "YES".</p></li>
</ol>
<p>We claim that line 4 runs in polynomial time. If <span class="math inline">\(n\)</span> is the power of some integer, the smallest integer is <span class="math inline">\(2\)</span>, which gives the power value <span class="math inline">\(\log n\)</span>. Therefore we need only to check for each integer <span class="math inline">\(i \in [\log n]\)</span> whether it holds that <span class="math inline">\(n^{1/i}\)</span> is a integer, which can be computed in polynomial time.</p>
<p>Now we prove the main theorem.</p>
<p><strong>Theorem</strong>: If <span class="math inline">\(n\)</span> is composite, then the algorithm output "YES" with probability at least <span class="math inline">\(1/2\)</span>.</p>
<p>Proof: we call <span class="math inline">\(x \in [n - 1]\)</span> a Rabin Miller witness, if <span class="math inline">\(n\)</span> is a composite and the algorithm outputs "YES" when choosing <span class="math inline">\(x\)</span>. Otherwise we call <span class="math inline">\(x\)</span> a Rabin Miller non-witness. Such <span class="math inline">\(x\)</span>'s satisfies <span class="math display">\[
    x^m \equiv 1 \text{ or } x^{2^i m} \equiv -1 \mod n \text{ for } 0 \le i &lt; k
\]</span></p>
<p>We are going to construct a proper subgroup <span class="math inline">\(S \subset Z_n^*\)</span>, such that all Rabin Miller non-witness belong to <span class="math inline">\(S\)</span>. Then by Lagrange Theorem, it holds that <span class="math display">\[
|\{ \text{Rabin Miller non-witness} \} | \le |S| \le \frac{1}{2} |Z_n^*| \le \frac{n}{2}
\]</span></p>
<p>The construction considers the collection of subsets: <span class="math display">\[
S_r = \{ x \in [n -  1] : x^r \equiv \pm 1 \mod n \}
\]</span> for <span class="math inline">\(r = m, 2m, 4m, ..., 2^k m\)</span>. Define <span class="math display">\[
S = \max_r S_r, s.t., \exists x \in S_r: x^r \equiv -1 \mod n
\]</span> In other words, <span class="math inline">\(S\)</span> is defined to be the set <span class="math inline">\(S_r\)</span> that contains an element whose <span class="math inline">\(r\)</span>-th power equals to <span class="math inline">\(-1\)</span> for the largest <span class="math inline">\(r\)</span>. Such <span class="math inline">\(S\)</span> must exists since <span class="math inline">\(-1 \in S_m\)</span>. <span class="math inline">\(S\)</span> has two important properties:</p>
<ol type="1">
<li>All Rabin Miller non-witness belongs to <span class="math inline">\(S\)</span>.</li>
<li><span class="math inline">\(S\)</span> is subgroup of <span class="math inline">\(Z_n^*\)</span>.</li>
<li><span class="math inline">\(\exists y \in Z_n^*\)</span>, s.t., <span class="math inline">\(y \notin S\)</span>, i.e., <span class="math inline">\(S \neq Z_n^*\)</span></li>
</ol>
<p>Property (1) is obvious by the definition of Rabin Miller non-witness. To show (2), we need to verify <span class="math inline">\(S\)</span> is close under multiplication, each element in <span class="math inline">\(S\)</span> belongs to <span class="math inline">\(Z_n^*\)</span> and is invertible in <span class="math inline">\(S\)</span>:</p>
<ul>
<li>If <span class="math inline">\(x \in S, y \in S\)</span>, then <span class="math inline">\((xy)^r \pm x^r y^r \equiv \pm 1 \mod n\)</span>.</li>
<li>If <span class="math inline">\(x \in S\)</span>, then <span class="math inline">\(x^r \equiv 1 \mod n\)</span> or <span class="math inline">\(x^{2r} \equiv 1 \mod n\)</span>. Clearly <span class="math inline">\(x\)</span> is invertible. Hence <span class="math inline">\(x \in Z_n^*\)</span>.</li>
<li>If <span class="math inline">\(x \in S\)</span>, then <span class="math inline">\(1 \equiv (x x^{-1})^r \equiv x^r x^{-r} \equiv x^{-r} \mod n\)</span>.</li>
</ul>
<p>Finally, we prove Property (3). As <span class="math inline">\(n\)</span> is composite, we can write <span class="math inline">\(n = ab\)</span>, where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are coprime. By definition of <span class="math inline">\(S\)</span>, <span class="math inline">\(\exists x \in S\)</span>, such that <span class="math display">\[
x^r \equiv -1 \mod n
\]</span> By Chinese Remainder Theorem, this is equivalent to <span class="math display">\[
x^r \equiv n-1 \mod a \wedge x^r \equiv n-1 \mod b
\]</span> i.e., <span class="math display">\[
x^r \equiv -1 \mod a \wedge x^r \equiv -1 \mod b
\]</span></p>
<p>However, another use of Chinese Remainder Theorem asserts <span class="math inline">\(\exists y \in [n]\)</span>, such that <span class="math display">\[
y \equiv x \mod a \wedge y \equiv 1 \mod b
\]</span></p>
<p>which implies that <span class="math display">\[
y^r \equiv x^r \equiv -1 \mod a \wedge y^r \equiv 1 \mod b
\]</span></p>
<p>Hence it is impossible that <span class="math inline">\(y^r \equiv \pm 1 \mod n\)</span>. It is left to prove <span class="math inline">\(y\)</span> is invertible module <span class="math inline">\(n\)</span>:</p>
<ul>
<li><span class="math inline">\(y \in Z_n^*\)</span>, as <span class="math inline">\(\gcd(x, n) = \gcd(x, ab) = 1 \rightarrow \gcd(x,a ) = 1 \wedge \gcd(x, b) = 1 \rightarrow \gcd(y, a) = \gcd(x, a) = 1 \rightarrow \gcd(y, ab) = 1\)</span>.</li>
</ul>
<p><span class="math inline">\(\blacksquare\)</span></p>
<h4 id="reference">Reference:</h4>
<ol type="1">
<li><a target="_blank" rel="noopener" href="http://theory.stanford.edu/~valiant/teaching/CS265/primality.pdf">Primality Testing, CS265/CME309, Fall 2017. Gregory Valiant</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/21/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><span class="page-number current">22</span><a class="page-number" href="/page/23/">23</a><span class="space">&hellip;</span><a class="page-number" href="/page/43/">43</a><a class="extend next" rel="next" href="/page/23/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">WOW</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">127</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WOW</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
